## MobX-React

### 03. mobx-reactì™€ hooks

---

### ğŸ“Œ mobx-reactì™€ hooks

ê¸°ë³¸ì ìœ¼ë¡œ `class` ì»´í¬ë„ŒíŠ¸ë“¤ì„ `hooks` ì»´í¬ë„ŒíŠ¸ë¡œ ë°”ê¿€ ë•Œì— ìœ ì˜í• ì ì€ `@observer` ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— í´ë˜ìŠ¤ì¸ ê²½ìš°ì—ë§Œ ì‚¬ìš©ê°€ëŠ¥í•˜ê³  ì´ ê²½ìš°ì—ëŠ” `useObserver` ë¥¼ ì‚¬ìš©í•´ì¤€ë‹¤.

```jsx
const App = () => {
  return useObserver(() => <div></div>);
};
```

ê¸°ì¡´ì— `render()` ì•ˆì— ë“¤ì–´ê°”ë˜ ê²ƒë“¤ì„ ì € ì•ˆì—ì„œ `return` í•´ì£¼ë©´ ë˜ê³ , `onLogIn / onLogOut / ...` ë“±ë“± ë©”ì†Œë“œëŠ” hooksì—ì„œëŠ” í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì•¼ í•˜ë‹ˆ `useCallback` ì„ ì‚¬ìš©í•´ì„œ ë§Œë“¤ì–´ì£¼ë©´ ëœë‹¤.

ê¸°ì¡´ì— ì‘ì—…í–ˆë˜ `local state` ë¶€ë¶„ì€ `const state` ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ `observable` ë¡œ ê°ì‹¸ì„œ ë°”ê¿”ì£¼ëŠ” ê²ƒë„ ë™ì‘ì€ í•˜ì§€ë§Œ `MobX` ì—ì„œ ì œê³µí•˜ëŠ” `useLocalStore` ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

ğŸ“ `useLocalStore` ì»´í¬ë„ŒíŠ¸ í•˜ë‚˜ ì•ˆì—ì„œë§Œ ë™ì‘í•œë‹¤. í•˜ì§€ë§Œ ì—„ë°€íˆ ë§í•˜ë©´ í•˜ë‚˜ ì•ˆì—ì„œë§Œ ë™ì‘í•˜ëŠ” ê²ƒë„ ì•„ë‹ˆê³ , ììœ ë¡­ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ ì“¸ ìˆ˜ê°€ ìˆê¸°ëŠ” í•˜ë‹¤.

```jsx
// local state
state = observable({
  name: "",
  password: "",
});

// hooks
// const state
const state = observable({});

// useLocalStore
const state = useLocalStore(() => ({
  name: "",
  password: "",
  onChangeName(e) {
    this.state.name = e.target.value;
  },

  onChangePassword(e) {
    this.state.password = e.target.value;
  },
}));
```

ë˜í•œ `useLocalStore` ì—ì„œë„ `state, action` ì„ ê°™ì´ ë¬¶ì–´ì£¼ë©´ ëœë‹¤.

#### ğŸ“ useCallback

`useCallback` ë˜ì§šì–´ë³´ê¸°.
`dependencies` ì¦‰, 2ë²ˆì§¸ ì¸ì ì•ˆì— ë°°ì—´ ì•ˆì— ë¬´ì—‡ì´ ë“¤ì–´ê°€ìˆëŠëƒì— ë”°ë¼ ë‹¤ë¥´ë‹¤. í˜„ì¬ `[]` ì²˜ëŸ¼ ë¹ˆ ë°°ì—´ë¡œ `dependency` ë¥¼ ì•ˆë„£ì–´ì£¼ê²Œ ëœë‹¤ë©´ `í•¨ìˆ˜ ì•ˆì˜ ë¶€ë¶„ì´ ë°”ë€” ì¼ì´ ì—†ë‹¤` .

í•˜ì§€ë§Œ `ë°°ì—´ ì•ˆì— ë“  ê°’` ì´ ìˆê³ , ì´ ê°’ì´ ë°”ë€Œê²Œ ë˜ë©´ `í•¨ìˆ˜ê°€ ìƒˆë¡œ ìƒì„±ëœë‹¤` .

### ğŸ“Œ App.jsx

```jsx
import React, { useCallback } from "react";
import { userStore, postStore } from "./store";
import { useLocalStore, useObserver } from "mobx-react";

const App = () => {
  const state = useLocalStore(() => ({
    name: "",
    password: "",
    onChangeName(e) {
      this.state.name = e.target.value;
    },

    onChangePassword(e) {
      this.state.password = e.target.value;
    },
  }));
  const onLogIn = useCallback(() => {
    userStore.logIn({
      nickname: "bibi",
      password: "ë¹„ë°€ë²ˆí˜¸",
    });
  }, []);

  const onLogOut = useCallback(() => {
    userStore.logOut();
  }, []);
  return useObserver(() => (
    <div>
      {userStore.isLoggingIn ? (
        <div>ë¡œê·¸ì¸ ì¤‘</div>
      ) : userStore.data ? (
        <div>{userStore.data.nickname}</div>
      ) : (
        "ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”."
      )}
      {!userStore.data ? (
        <button onClick={onLogIn}>ë¡œê·¸ì¸</button>
      ) : (
        <button onClick={onLogOut}>ë¡œê·¸ì•„ì›ƒ</button>
      )}
      <div>{postStore.data.length}</div>
      <input value={state.name} onChange={state.onChangeName} />
      <input
        value={state.password}
        type="password"
        onChange={state.onChangePassword}
      />
    </div>
  ));
};

export default App;
```

- `class component` - `observable`
- `hooks component` - `useObserver`

ì´ ë‘ê°œê°€ ìˆì–´ì•¼ `observable` ì´ ë°”ë€”ë•Œ ë°˜ì‘ì´ ëœë‹¤.

#### ğŸ“ Reaction

`reaction` ì„ ë“±ë¡í•´ë†“ìœ¼ë©´ `mobx devtools` ì—ì„œë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

#### ğŸ“ ê³µì‹ë¬¸ì„œ

ê³µì‹ë¬¸ì„œë¥¼ ë³´ë©´ ì¢€ íŠ¹ì´í•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, `contextAPI` ë¡œ `global store` ë¥¼ ê´€ë¦¬í•˜ëŠ” ì˜ˆì œê°€ í•˜ë‚˜ ë” ë‚˜ì˜¨ë‹¤.

`store` ë¥¼ `import` í•´ì„œ ë°”ë¡œ ì¨ë„ ë˜ëŠ”ë° `App + Store` ë¥¼ ë¬¶ëŠ” ë°©ë²•ë„ ìˆë‹¤.
`PRrovider Inject / ProviderConsumer`

```js
// import
import { useLocalStore, useObserver } from "mobx-react";

// app + store

// context.jsx
import * as React from "react";
import { userStore, postStore } from "./store";

export const storeContext = React.createContext({
  userStore,
  postStore,
});

export const StoreProvider = ({ children }) => {
  return <storeContext.Provider>{children}</storeContext.Provider>;
};

export default StoreProvider;

// useStore.js
import React from "react";
import { storeContext } from "./Context";

function useStore() {
  const { userStore, postStore } = React.useContext(storeContext);

  return { userStore, postStore };
}
```

ë¨¼ì € `Context.jsx` ë¥¼ ë§Œë“¤ê³  `react.createContext` ë¡œ ê·¸ ì•ˆì—ë‹¤ê°€ `store` ë“¤ì„ ë¬¶ì–´ì£¼ë©´ ëœë‹¤. ê·¸ë ‡ê²Œ ë˜ë©´ `Context` ë¡œ ë¬¶ì´ëŠ”ë° `contextë¥¼ ì œê³µí•˜ëŠ” ê²ƒì´ provider` ì´ë‹¤.

ì´ `provider` ëŠ” `client.jsx` ì— `<StoreProvider>` ë¡œ ê°ì‹¸ì£¼ë©´ ëœë‹¤.

ê·¸ë ‡ê²Œ ë˜ë©´ `App` ë¶€ë¶„ì—ì„œ `store` ë“¤ì„ ì“¸ ìˆ˜ ìˆë„ë¡ ì§œì—¬ì§„ë‹¤.

`custom hook` ì—ì„œ `useContext` ë¡œ ì•„ê¹Œ ë§Œë“¤ì–´ ë†“ì•˜ë˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤.

ì´ë ‡ê²Œ ë˜ë©´

```jsx
const { userStore, postStore } = useStore();
```

ë¡œ ê°€ì ¸ì™€ì„œ ì“¸ ìˆ˜ ìˆë‹¤. `ê¸€ë¡œë²Œ ì  / ì»¨í…ìŠ¤íŠ¸api` ë‘ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ë¬¶ì–´ì£¼ëŠ” ë°©ë²•ì´ ìˆë‹¤.

> ì·¨í–¥ì˜ ì°¨ì´.
> `ì»¤ìŠ¤í…€ í›…` ìœ¼ë¡œ `contextAPI` ë¥¼ ì‚¬ìš©í•˜ë©´ ì¡°ê¸ˆ ë” ë³µì¡í•´ì§„ë‹¤. ì´ë ‡ê²Œ ììœ ë¥¼ ì¤„ ìˆ˜ ìˆëŠ”ë° ì´ë ‡ê²Œ ë˜ë©´ ì¥ì ì´ `ê·¸ ì»´í¬ë„ŒíŠ¸ë‘ ë¬¶ì—¬ì„œ í•˜ë‚˜ì²˜ëŸ¼ ì¸ì‹` ë  ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ ë‹¨ì ì€ ê·¸ëƒ¥ `import` ë¡œ í•´ë„ ëœë‹¤.
