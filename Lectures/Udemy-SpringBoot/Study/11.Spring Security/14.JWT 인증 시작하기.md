## Spring Security

### 14. JWT μΈμ¦ μ‹μ‘ν•κΈ°

---

### π“ JWT

![](https://velog.velcdn.com/images/bibiboy/post/0a2c101e-28c5-4354-96a5-1a90e9c0f3e9/image.png)

`JOT / JWT` μ— λ€ν•΄ μ•μ•„λ³΄μ.

κΈ°λ³Έ μΈμ¦μ κ²½μ°μ—λ” κΈ°λ³Έ μΈμ¦ ν—¤λ”μ— λ§λ£ κΈ°ν•μ΄ μ—†κ³ , μ‚¬μ©μμ— κ΄€λ ¨λ μ„Έλ¶€μ •λ³΄λ„ μ „ν€ μ—†λ‹¤.
μ‚¬μ©μμ—κ² μ–΄λ–¤ κ¶ν•μ΄ μλ”μ§€ λν• μ• μ μ—†λ‹¤. λν• μ•„μ£Ό μ‰½κ² λ””μ½”λ”© ν•  μ μκ³ , `λ³΄μ• κ²°ν•¨` μ΄ μμ„ μ μλ‹¤λ” λ¬Έμ κ°€ μλ‹¤.

μ΄λ° λ•μ— `JWT(Json Web Token)` μ„ μ΄μ©ν•΄μ•Ό ν•λ‹¤.
μ΄λ” μ•μ „ν•κ² ν΄λ μ„μ„ ν‘μ‹ν•κΈ° μ„ν• κ³µκ° μ‚°μ—… ν‘μ¤€μ΄λ‹¤.
`JWT` μ—λ” μ‚¬μ©μ μ„Έλ¶€μ •λ³΄ / μΈμ¦μ„ λ¨λ‘ λ‹΄μ„ μ μλ‹¤.

#### μ–΄λ–¤ μ„Έλ¶€μ •λ³΄λ¥Ό λ‹΄μ„ μ μμ„κΉ?

![](https://velog.velcdn.com/images/bibiboy/post/734ccf96-3513-43a4-b72c-776e3fef0174/image.png)

`ν—¤λ”` λ¥Ό λ‹΄μ„ μ μκ³ , `ν† ν°μ νƒ€μ… / μ•κ³ λ¦¬μ¦` μ¦‰, μ‚¬μ©λ ν•΄μ‹± μ•κ³ λ¦¬μ¦μ„ λ‹΄μ„ μ μκ³ , `payload` λν• λ‹΄μ„ μ μλ‹¤.

- ν† ν°μ λ°ν–‰μκ°€ λ„κµ°μΈμ§€λ¥Ό λ‚νƒ€λ‚΄λ” `iss`
- ν† ν°μ μ£Όμ λ¥Ό λ‚νƒ€λ‚΄λ” `sub`
- μ‚¬μ© λ€μƒμ„ λ‚νƒ€λ‚΄λ” `aud`
- ν† ν°μ λ§λ£ λ‚ μ§λ¥Ό λ‚νƒ€λ‚΄λ” `exp`
- ν† ν°μ΄ λ°ν–‰λ μ‹κ°„μ„ λ‚νƒ€λ‚΄λ” `iat`
  λ“±λ“± ν‘μ¤€ μ†μ„±λ“¤μ΄ μλ‹¤.

μμ‹ λ§μ μ‚¬μ©μ μ§€μ • μ†μ„±μ„ μ¶”κ°€ν•  μλ„ μλ‹¤.
λν• JWTμ—λ” `μ‹κ·Έλ‹μ²` λ„ ν¬ν•¨λμ–΄ μλ”λ°, `Base64` λ΅ μΈμ½”λ”©λ ν—¤λ”μ κ°’, κ·Έλ¦¬κ³  `Base64` λ΅ μΈμ½”λ”©λ νμ΄λ΅λ“μ κ°’, κ·Έλ¦¬κ³  μ¨κ²¨μ•Όν•  κ²ƒλ“¤μ΄ μ΅°ν•©λμ–΄ μλ‹¤.

`jwt.io` μ—μ„ `JWT` λ¥Ό `λ””μ½”λ“, κ²€μ¦, μƒμ„±` ν•  μ μλ‹¤.
`JWT` μ—μ„ μ°λ¦¬λ” ν‚¤λ¥Ό μ΄μ©ν•μ—¬ `μ•”νΈν™” / λ³µνΈν™”` λ¥Ό ν•  μ μλ‹¤.

#### μ•”νΈν™”

μ—¬κΈ°μ„ λ§ν•λ” μ•”νΈν™”μ—λ” `λ‘ κ°€μ§€ νƒ€μ…` μ΄ μλ‹¤.

- `λ€μΉ­ ν‚¤ μ•”νΈν™”` : λ™μΌν• ν‚¤λ¥Ό μ΄μ©ν•μ—¬ `μ•”νΈν™” / λ³µνΈν™”`
  μ¦‰, μ•”νΈν™” μ•κ³ λ¦¬μ¦, λ³µνΈν™” μ•κ³ λ¦¬μ¦ λ¨λ‘μ—μ„ `λ™μΌν• λ°μ΄ν„° μ•”νΈν™” ν‚¤` λ¥Ό μ‚¬μ©ν•λ‹¤.

μ—¬κΈ°μ„ `λ€μΉ­ ν‚¤ μ•”νΈν™”` λ¥Ό μ‚¬μ©ν•  λ• μ¤‘μ”ν• μ μ€, `μ¬λ°”λ¥Έ μ•κ³ λ¦¬μ¦` μ„ μ„ νƒν•΄μ•Ό ν•λ‹¤λ” μ μ΄λ‹¤.
κ·Έ λ‹¤μμΌλ΅λ” ν‚¤λ¥Ό μ•μ „ν•κ² λ³΄κ΄€ν•΄μ•Ό ν•λ‹¤. νƒ€μΈμ΄ μ•΅μ„Έμ¤ν•λ©΄ μ•λκΈ° λ•λ¬Έμ—.
λν• μ•”νΈν™”ν‚¤λ¥Ό `κ³µμ ` ν•λ” λ°©λ²•μ΄ μ¤‘μ”ν•λ‹¤.

νƒ€μΈκ³Ό μ•”νΈλ¬Έμ„ κ³µμ ν•λ‹¤λ©΄ λ°μ΄ν„° μ•”νΈν™” ν‚¤λ¥Ό κ³µμ ν•  λ°©λ²•λ„ μ°Ύμ•„μ•Ό ν•λ‹¤. `λ€μΉ­ ν‚¤ μ•”νΈν™”μ λ€μ•` μ΄ λ°”λ΅ `λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™”` μ΄λ‹¤.

- `λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™”` : μ„λ΅ λ‹¤λ¥Έ ν‚¤λ¥Ό μ΄μ©ν•μ—¬ `μ•”νΈν™” / λ³µνΈν™”`
  λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™”μ—λ” λ‘ κ°€μ§€ ν‚¤κ°€ μλ‹¤. `κ³µκ° ν‚¤ / λΉ„λ°€ ν‚¤` μ΄κ±Έ `κ³µκ° ν‚¤ μ•”νΈκΈ°λ²•` μ΄λΌκ³ λ„ λ¶€λ¥Έλ‹¤.
  λ‚΄κ°€ `κ³µκ° ν‚¤` λ¥Ό μ΄μ©ν•΄μ„ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•κ³  `λΉ„λ°€ ν‚¤` λ¥Ό μ΄μ©ν•΄μ„ λ³µνΈν™” ν•  μ μλ‹¤.

κ³µκ° ν‚¤λ” λ„κµ¬μ—κ²λ‚ κ³µμ ν•  μ μκ³ , λΉ„λ°€ ν‚¤λ” λ‚΄κ°€ λ³΄κ΄€ν•λ©΄ λλ‹¤. `κ°μΈ ν‚¤` μΈ μ…μ΄λ‹¤.

> λ„κµ°κ°€κ°€ κ³µκ° ν‚¤λ¥Ό μ΄μ©ν•΄μ„ λΉ„λ°€ ν‚¤λ¥Ό μ•μ•„λ‚Ό μ μμ§€ μ•μ„κΉ ν•λ”λ°, μ΄λ° μ•κ³ λ¦¬μ¦μ€ μ•„μ£Ό κ°•λ ¥ν•λ‹¤. μ„¤λ Ή `κ³µκ° ν‚¤` κ°€ μλ‹¤κ³  ν•λ”λΌλ„ κ·Έμ— μƒμ‘ν•λ” `λΉ„λ°€ ν‚¤` λ¥Ό μ‰½κ² μƒμ„±ν•  μλ” μ—†λ‹¤.
> κ·Έλ¦¬κ³  `JWT` λ¥Ό μ‚¬μ©ν•λ” κ²½μ°μ—λ” `λΉ„λ€μΉ­ ν‚¤` λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ •μ„μ΄λ‹¤.

#### JWTμ μ „λ°μ μΈ νλ¦„

μ–΄λ–¤ μ•±μ΄ `JWT` λ¥Ό μ‚¬μ©ν•κ³  μλ‹¤κ³  ν•΄λ³΄μ. JWTλ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ λ‹¤μ–‘ν• μ„Έλ¶€μ •λ³΄λ¥Ό μΈμ½”λ”© ν•΄μ•Όν•λ‹¤.
λ¨Όμ € `μ‚¬μ©μ μκ²©μ¦λ…` μ„ μΈμ½”λ”© ν•΄μ•Όν•κΈ° λ•λ¬Έμ— `μ‚¬μ©μ μ΄λ¦„ / ν¨μ¤μ›λ“` κ°€ ν•„μ”ν•κ³ , μ‚¬μ©μ λ°μ΄ν„°λ„ ν•„μ”ν•κ³ , μκ²©μ¦λ…μ„ κΈ°μ΄λ΅ `μ‚¬μ©μ λ°μ΄ν„°` λ¥Ό λ°›μ„ μλ„ μλ‹¤. μ΄κ±Έ `νμ΄λ΅λ“` λΌκ³  ν•λ‹¤.

κ·Έλ¦¬κ³  λ `ν‚¤ μ` μ΄ ν•„μ”ν•λ‹¤. λΉ„λ€μΉ­ ν‚¤λ¥Ό μ‚¬μ©ν•λ ¤κ³  ν•λ”λ°, κ·Έκ²ƒμ„ `ν‚¤ μ` μ΄λΌκ³  λ§ν•λ‹¤.
κ·Έλμ„ `RSA ν‚¤ μ` λ„ ν•„μ”ν•λ‹¤.
μΌλ‹¨ JWTλ¥Ό μƒμ„±ν–λ‹¤λ©΄ `μ”μ²­ ν—¤λ”μ μΌλ¶€` λ΅μ„ `JWT` λ¥Ό μ „μ†΅ν•΄μ•Ό ν•λ‹¤.
μΈμ¦ ν—¤λ”μ μΌλ¶€λ΅μ„ `Bearer ν† ν° ν•νƒ` λ΅ κ·Έκ²ƒμ„ μ „μ†΅ν•κ³ , μ¦‰, `Authorization: Bearer` λΌκ³  ν•κ³ , μƒμ„±ν• ν† ν°μ„ μ „μ†΅ν•λ‹¤.

μ΄λ ‡κ² μ²« λ‹¨κ³„λ” `JWTλ¥Ό μƒμ„±` ν•λ” λ‹¨κ³„μ΄κ³ , κ·Έ μ΄ν›„μ—λ” `λ¦¬μ†μ¤μ— μ•΅μ„Έμ¤` ν•κΈ° μ„ν•΄ μ”μ²­ ν—¤λ”μ μΌλ¶€λ΅μ„ μ „μ†΅ν•λ” λ‹¨κ³„μ΄λ‹¤. λ§μ§€λ§‰μΌλ΅λ” `JWTκ°€ μ„λ²„μ—μ„ ν™•μΈ` λλ” λ‹¨κ³„μ΄λ‹¤.
μ„λ²„κ°€ κ·Έκ±Έ λ°›μΌλ©΄ λ””μ½”λ”© ν•΄μ•Όν•κ³ , κ·Έκ²ƒμ„ ν•κΈ° μ„ν•΄ λ‹¤μ‹ `ν‚¤ μ(κ³µκ°ν‚¤)` κ°€ ν•„μ”ν•λ‹¤.
