## Spring Security

### 09. CORS 시작하기

---

### 📌 CORS

`CORS`, 오리진 간 리소스 공유에 대해 알아보자.

브라우저에서 현재 오리진 외부에 있는 리소스에 `AJAX 호출` 을 보내는 것은 허용되지 않는다.
풀 스택 애플리케이션에서 사용자가 다른 도메인, 다른 URL에 REST API 호출을 실행한다고 가정해보자.
브라우저에서 이러한 호출은 대개 허용되지 않는다.
그런데 도메인 간 허용되는 요청을 설정할 수 있는 규격이 바로 `Corss-Origin Resource Sharing` 이다.

사용 가능한 접근법은 2가지 이다.
하나는 `글로벌 설정` 이고, 다른 하나는 `모든 컨트롤러에서 로컬 설정` 을 사용하는 것이다.
글로벌 설정은 `모든 컨트롤러, 모든 리소스, 모든 REST 컨트롤러` 에 적용된다.

#### 📍 글로벌 설정

![](https://velog.velcdn.com/images/bibiboy/post/d2f14336-1a65-4a31-8e6c-9ebcdd12232d/image.png)

글로벌 설정을 적용하려면 `addCorsMappings 콜백 메소드` 를 `WebMvcConfigurer` 에 추가한다. 이 `Bean` 을 복사해 어떤 `Spring` 설정 파일에든 붙여 넣어도 된다.

`BasicAuthSecurityConfiguration` 에도 이 `Bean` 을 추가할 수 있다.
이 메소드는 특정 오리진에서 오는 것이라면 어떠한 요청 메소드를 사용하든 모든 `URL` 에 대한 요청을 허용한다.

예시에서는 `localhost:3000` 에서 요청이 들어온다면 `앱 / API` 에서 이 요청을 수락하게 되는것.

#### 📍 로컬 설정

`특정 요청 메소드 / 특정 컨트롤러 클래스` 에 `@CrossOrigin` 을 추가하는 방법이다.
기본적으로 모든 오리진을 허용하지만 필요에 따라 커스터마이즈 할 수 있다.
`@CrossOrigin(origins="http://www.in28minutes.com")` 으로 지정한다면 이 특정 오리진의 요청만 허용 된다.

> ✅ CORS, 오리진 간 리소스 공유
> 다른 도메인 간에 허용되는 요청을 설정할 수 있는 규격이다. 글로벌 설정은 `모든 컨트롤러 / 모든 리소스 메소드` 에 대해 한번에 설정할 수 있고, 로컬 설정은 `요청 메소드 / REST 컨트롤러 각각` 에 적용할 수 있고, 구체적으로 커스터마이즈도 할 수 있다.
