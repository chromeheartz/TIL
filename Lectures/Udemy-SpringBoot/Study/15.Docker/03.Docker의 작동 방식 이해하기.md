## Docker

### 03. Docker의 작동 방식 이해하기

---

### 📌 Docker의 작동방식

#### Docker가 왜 유명할까?

![](https://velog.velcdn.com/images/bibiboy/post/cc49915e-4869-4148-953b-d7e18bf898d5/image.png)

#### Docker가 왜 유명할까?

- `Docker` 는 표준화된 애플리케이션 패키징을 제공하기 때문에 인기가 많다.
- 모든 애플리케이션을 동일한 방식으로 패키징할 수 있는 `Docker 이미지` 를 생성할 수 있다.
- 최종 `Docker 이미지` 의 포맷은 동일하며 실행 방식도 같다.
- `다중 플랫폼 지원` 이 있다. → 로컬 머신, 데이터 센터, AWS, Azure, GCP 등 어디서든 실행 가능하다. 필요한 것은 `Docker 런타임` 설치뿐이다.
- `격리성` 이 있다. → 여러 컨테이너를 같은 머신에서 실행해도 컨테이너끼리는 격리된다.

<hr />

![](https://velog.velcdn.com/images/bibiboy/post/795a9ec3-45e9-4f20-b6f1-c7aa32451645/image.png)

### 📌 명령어 예시

```bash
docker container run -d -p 5000:5000 in28min/hello-world-nodejs:0.0.1.RELEASE
```

- 위 명령 실행 시 → 브라우저에서 `localhost:5000` 접속하면 Hello World JavaScript v1 출력됨.
- 백그라운드에서 일어나는 과정은 다음과 같다.

<hr />

### 📌 Docker 이미지와 컨테이너

- Docker 이미지는 정적인 바이트 집합이다.
- 이미지는 `Docker 레지스트리(기본: Docker Hub)` 에 저장된다.
- 컨테이너는 특정 이미지 버전을 실행한 동적인 인스턴스이다.
- 하나의 Docker 이미지에서 원하는 만큼 컨테이너를 생성할 수 있다.
  - 같은 애플리케이션을 1000개 실행하는 것도 가능하다.

<hr />

### 📌 레지스트리와 저장소

- 레지스트리 = 여러 저장소(repository)를 포함한다.
- 저장소 = 특정 애플리케이션/마이크로서비스에 대한 이미지 집합이다.
- 예시: `in28min/hello-world-nodejs`
- 태그(tag): `0.0.1.RELEASE, 0.0.2.RELEASE`
- 태그는 특정 버전을 의미한다. (예: `v1` , `v2` , `v3` …)
- 같은 구조로 `in28min/hello-world-java` , `in28min/hello-world-python` 저장소도 존재한다.

<hr />

### 📌 -p 옵션 (포트 매핑)

- `-p 5000:5000` → 호스트 포트 5000 ↔ 컨테이너 내부 포트 5000 매핑.
- 컨테이너 내부 포트는 이미지 개발자가 지정한 것이므로 변경 불가.
- 호스트 포트는 변경 가능하다.
  - 예: `-p 5001:5000` → 호스트 5001 포트에서 접근 가능.
- 같은 이미지로 여러 컨테이너 실행 가능하다.
  - 예: 하나는 `-p 5001:5000`, 다른 하나는 `-p 5002:5000`
  - 두 컨테이너 모두 같은 이미지를 기반으로 실행된다.

<hr />

### 📌 -d 옵션 (detached 모드)

- `-d` 를 붙이면 컨테이너 실행 후 터미널 제어권이 즉시 돌아온다.
- `-d` 없이 실행하면 → 터미널이 컨테이너와 직접 연결된다.
  - 이 경우 `Ctrl+C` 또는 `Command+C` 입력 시 컨테이너 종료.
- `-d` 는 컨테이너 수명과 터미널을 분리하는 역할을 한다.

<hr />

### 📌 컨테이너 관리

- 실행 중인 컨테이너 확인 → `docker container ls`
- 실행 중인 컨테이너 중지 → `docker container stop <컨테이너ID>`
- ID 전체를 입력하지 않고 앞 몇 글자만 입력해도 된다.
- 컨테이너가 중단되면 매핑된 호스트 포트 접근도 불가하다.

<hr />

### 📌 네트워크

- 기본적으로 컨테이너는 **Bridge 네트워크**를 사용한다.
- Bridge 네트워크는 외부 사용자가 직접 접근할 수 없다.
- 따라서 `-p` 옵션을 사용해 컨테이너 포트를 호스트 포트에 매핑해야 한다.

<hr />

### 📌 정리

- Docker 이미지는 Docker 레지스트리에서 다운로드된다.
- 이미지는 정적이며, 컨테이너는 실행 중인 동적 인스턴스이다.
- `-p` 옵션 → 내부 컨테이너 포트를 호스트 포트로 매핑한다.
- `-d`![업로드중..](blob:https://velog.io/3ace70d5-9579-4081-81b8-c02cff25734d)
  옵션 → detached 모드 실행, 터미널과 컨테이너 수명을 분리한다.
