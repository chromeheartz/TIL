## Spring Boot

### 11. Production ν™κ²½ λ°°ν¬ μ¤€λΉ„ν•κΈ° -4-

---

### π“ Production ν™κ²½ λ°°ν¬ μ¤€λΉ„ν•κΈ° -4-

#### Monitoring

μ• ν”λ¦¬μΌ€μ΄μ…μ λ°±κ·ΈλΌμ΄λ“μ—μ„ μ–΄λ–¤ μΌμ΄ λ°μƒν•λ”μ§€ ν™•μΈν•κ³  μ‹¶μ„ λ• μ‚¬μ©ν•  μ μλ” κΈ°λ¥μ΄ `Spring boot Actuator` μ΄λ‹¤.
μ΄λ¥Ό ν†µν•΄ `ν”„λ΅λ•μ…` λ‹¨κ³„μ μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ¨λ‹ν„°λ§ν•κ³  κ΄€λ¦¬ν•  μ μλ‹¤.
`Actuator` λ” μ—¬λ¬ κ°μ μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•λ”λ°, μ• ν”λ¦¬μΌ€μ΄μ…μ— ν¬ν•¨λ λ¨λ“  `Bean` μ„ μ΄ μ—”λ“ν¬μΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ ν™•μΈν•  μ μλ‹¤.

`health` μ—”λ“ν¬μΈνΈλ΅λ” μ• ν”λ¦¬μΌ€μ΄μ…μ μƒνƒ μ •λ³΄λ¥Ό ν™•μΈν•  μ μκ³ ,
`metrics` μ—”λ“ν¬μΈνΈλ” μ• ν”λ¦¬μΌ€μ΄μ…κ³Ό κ΄€λ ¨λ μ—¬λ¬κ°€μ§€ `metrics` λ¥Ό μ κ³µν•λ‹¤.
λ§¤ν•‘ κ΄€λ ¨ μ„Έλ¶€ μ‚¬ν•­μ„ ν™•μΈν•λ ¤λ©΄ `mappings` μ—”λ“ν¬μΈνΈλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

#### κ·ΈλΌ μ–΄λ–»κ² μ‚¬μ©ν• κΉ?

`pom.sml` μ— μ¶”κ°€ν•΄μ£Όμ

```xml
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

![Image](https://github.com/user-attachments/assets/e63713f2-56f8-469c-9ea8-a1ee8fa2a130)

κ·Έλ¦¬κ³  μ„λ²„λ¥Ό ν‚¨ ν›„μ— `/actuator` URLμ„ ν™•μΈν•΄λ³΄λ©΄ ν„μ¬ URLλ΅ μ—°κ²°λλ” `self` λ„ μκ³ , `health` λ΅ μ—°κ²°μ‹ν‚¬μλ„μλ‹¤.
health URLμ„ ν™•μΈν•΄λ³΄λ©΄ `status: "UP"` μΌλ΅ μ‹¤ν–‰μ¤‘μ„μ„ λ‚νƒ€λ‚Έλ‹¤.

β­οΈ λ§μ•½ `Actuator` μ—μ„ λ” λ§μ€ κΈ°λ¥μ„ μ‚¬μ©ν•κ³  μ‹¶λ‹¤λ©΄ `application.properties` μ—μ„ κΈ°λ¥μ„ μ‚¬μ© μ„¤μ •ν•΄μ•Όν•λ‹¤.

μ¶”κ°€ μ—”λ“ν¬μΈνΈλ¥Ό μ„¤μ •ν•λ” κ²ƒμ΄κΈ° λ•λ¬Έμ—

```xml
management.endpoints.web.exposure.include=*
```

λ¥Ό μ„¤μ •ν•΄μ£Όλ©΄ λ¨λ“  μ—”λ“ν¬μΈνΈκ°€ λ…Έμ¶λκ² λλ‹¤.

![Image](https://github.com/user-attachments/assets/eb34c06c-b777-4be1-b925-343be76df532)

μ΄μ „λ³΄λ‹¤ λ” λ§μ€ μ—”λ“ν¬μΈνΈλ¥Ό ν™•μΈν•  μ μλ‹¤.

#### μ¤‘μ”ν• λ‡κ°€μ§€

```json
"beans": {
  "href": "http://localhost:8080/actuator/beans",
  "templated": false
},
```

`beans` μ—λ” λ΅λ“λ λ¨λ“  `Bean` λ“¤μ΄ ν‘μ‹λλ‹¤.

![Image](https://github.com/user-attachments/assets/e1a9f126-a96b-4bed-bb46-1089a7178226)

λ‚΄κ°€ λ§λ“¤μ—λ `courseController` λν• μκ³  λ³΄λ‹¤λ³΄λ©΄ `DispatcherServlet / ErrorMVC` μ— κ΄€ν• λΉλ“¤λ„ μλ‹¤.
λ”°λΌμ„ μλ™ μ„¤μ •λ λ¨λ“  κ²ƒμ— λ€ν•΄μ„λ” μ—¬κΈ° ν‘μ‹λλ‹ `Bean` μ„ ν™•μΈν•λ©΄ λκ³ , νΉμ • ν•­λ©μ΄ μλ™μ„¤μ •λμ—λ”μ§€ μ•„λ‹μ§€λ” ν™•μΈν•  μλ„ μλ‹¤.

```json
"configprops": {
  "href": "http://localhost:8080/actuator/configprops",
  "templated": false
},
```

`configprops` λ” μ—΄μ–΄λ³΄λ©΄ `application.properties` μ—μ„ μ„¤μ •ν•  μ μλ” λ¨λ“  ν•­λ©μ΄ ν‘μ‹λλ‹¤. `currency` λ΅ κ²€μƒ‰μ„ ν•΄λ³΄λ©΄ λ‚΄κ°€ λ§λ“ κ²ƒμ„ λ³Ό μ μλ‹¤.

```json
"env": {
  "href": "http://localhost:8080/actuator/env",
  "templated": false
},
```

`env` λ΅ μ΄λ™ν•λ©΄ ν™κ²½μ— κ΄€ν• μ„Έλ¶€μ‚¬ν•­μ„ λ¨λ‘ ν‘μ‹ν•λ‹¤. μ–΄λ–¤ ν”„λ΅ν•„μ„ μ‚¬μ©ν•λ”μ§€ μ–΄λ–¤ ν¬νΈλ¥Ό μ‚¬μ©ν•λ”μ§€ λ“±μ„ μ• μ μλ‹¤.

```json
"metrics": {
  "href": "http://localhost:8080/actuator/metrics",
  "templated": false
},
```

`metrics` λ¥Ό μ—΄μ–΄λ³΄κ²λλ©΄ `μ• ν”λ¦¬μΌ€μ΄μ… μ‹μ‘ μ‹κ°„ / λ””μ¤ν¬ μ—¬μ  κ³µκ°„ / μ΄ κ³µκ°„` λ“±μ„ ν™•μΈν•  μ μκ³  `JVM` κ΄€λ ¨ν• κ²ƒλ“¤λ„ μλ‹¤.
μ΄μ¤‘ `http://localhost:8080/actuator/metrics/http.server.requests` λ¥Ό ν™•μΈν•΄λ³΄λ©΄ requestsμ— κ΄€ν• λ¨λ“ κ²ƒλ“¤μ΄ λ‚μ¨λ‹¤.
μ”μ²­ κ°μ / μ”μ²­μ„ μ²λ¦¬ν•λ” μµλ€ μ‹κ°„ λ“±λ“±μ΄ λ‚μ¨λ‹¤.
μƒλ΅κ³ μΉ¨μ„ ν•  λ•λ§λ‹¤ `count` κ°€ λμ–΄λ‚λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤. μ”μ²­μ„ ν•κ³ μκΈ° λ•λ¬Έ.

> β… `Actuator` μ— κ΄€ν•΄ κΈ°μ–µν•΄μ•Όν•  μ¤‘μ”ν• ν• κ°€μ§€λ” μ—¬λ¬ μ—”λ“ν¬μΈνΈλ¥Ό μ‚¬μ© μ„¤μ •ν•λ©΄ ν•΄λ‹Ή μ •λ³΄λ¥Ό λ§μ΄ μμ§‘ν•λ‹¤λ” κ²ƒμ΄κ³ , μ •λ³΄λ¥Ό λ§μ΄ μμ§‘ν•λ©΄ `CPU / λ©”λ¨λ¦¬` κ°€ λ§μ΄ μ‚¬μ©λλ‹¤λ” μ μ΄λ‹¤.
> μΌλ°μ μΌλ΅ μ—”λ“ν¬μΈνΈλ¥Ό ν¬ν•¨ν•λ ¤λ©΄ λ…μ‹μ μΌλ΅ ν•΄μ•Όν•λ‹¤.

μλ¥Ό λ“¤μ–΄ `health, metrics` λ¥Ό μ„¤μ •ν•  μ μμ—λ”λ°, μ΄κ²ƒμ΄ μ‚¬μ©ν•λ” μ μΌν• μ—”λ“ν¬μΈνΈλΌλ©΄
`management.endpoints.web.exposure.include=health,metrics`
μ΄λ°μ‹μΌλ΅ μ„¤μ •ν•΄μ£Όλ©΄ λλ‹¤.

**β­οΈμ΄λ° λ°©λ²•μΌλ΅ ν”„λ΅λ•μ… ν™κ²½μ μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ¨λ‹ν„°λ§ ν•  μ μλ‹¤.**
