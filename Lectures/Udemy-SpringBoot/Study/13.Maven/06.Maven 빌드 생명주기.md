## Maven

### 06. Maven 빌드 생명주기

---

### 📌 빌드 생명주기

![](https://velog.velcdn.com/images/bibiboy/post/c5c44546-1e4c-454f-947c-0d2b20234c4f/image.png)

Maven의 핵심은 `빌드 생명주기(Build Lifecycle)` 이다.

#### `빌드 생명 주기` 가 왜 중요할까?

Maven 명령어를 실행하면 이 빌드 생명주기가 순차적으로 실행된다. 빌드 생명주기란 일련의 단계인데, 이런 일련의 단계들마다 각각 하는 일이 있고, 이런 단계들이 생명주기를 구성한다.
빌드 생명주기는 `여러 단계(phase)` 로 구성되고, 각 단계는 특정한 작업을 담당한다

일단 `Run as - Maven Build` 에서 `install` 을 실행해보자.
많은 작업들이 일어나는데 보면 먼저 리소스를 복사하고, 모듈을 컴파일한다.
소스코드를 컴파일한다. 소스 폴더에 Java 파일이 하나 있는데, 그걸 target 안의 특정 폴더에 컴파일 한 것이다.

테스트 파일도 컴파일 한 것을 볼 수 있다. 단위 테스트가 있는지 확인해 그것까지 컴파일한다.

이제 프로젝트 코드를 보게 되면 Java 소스파일 1개 / Java 테스트 파일 1개가 있는것을 볼 수 있고, 두 파일 다 컴파일 된다. 소스 코드가 먼저 컴파일되고, 이어서 테스트 파일이 컴파일 된다.

그런 다음 단위 테스트가 실행되고, 모든 단위테스트가 성공적으로 끝나면 `JAR 파일` 을 빌드하기 시작한다.
현재 `Spring Boot` 를 사용중이라 `spring-boot-maven-plugin` 이라는 플러그인으로 `JAR 파일` 을 리패킹한다.
끝으로 설치 단계에는 생성된 JAR파일이 Maven 로컬 저장소에 복사된다.

이렇듯 간단한 Maven 명령어도 `여러 단계` 를 거친다는 사실을 알 수 있다.

`target` 폴더를 한번 봐보자.
우클릭으로 `Show in - system explorer` 를 선택해서 보면 폴더의 모든 내용을 보여주는데 보다시피 컴파일된 클래스들이 있다.

![](https://velog.velcdn.com/images/bibiboy/post/f23c7a55-6e7b-4075-8fb7-1131d3b425a0/image.png)

소스코드가 컴파일돼서 여기에 컴파일된 클래스가 있는것이다.
`reports` 폴더는 `단위 테스트 실행 결과` 를 보여준다.
![](https://velog.velcdn.com/images/bibiboy/post/f696c954-8e60-4128-a197-c2a9433bb5e9/image.png)

이렇듯 `mvn clean install` 명령어를 실행하면 `Maven` 은 최종 `JAR 파일` 을 생성하기까지 많은 작업을 한다. 그와 관련된 아티팩트들은 모두 `target` 폴더에 있다.

#### 주요 단계 정리

- `validate` : 프로젝트가 올바른지 확인
- `compile` : Java 소스 코드를 컴파일
- `test` : 단위 테스트 실행
- `package` : JAR(WAR) 파일 생성
- `integration`-test : 통합 테스트 실행
- `verify` : 품질 검증
- `install` : 로컬 저장소(~/.m2/repository)에 설치
- `deploy` : 원격 저장소로 배포
