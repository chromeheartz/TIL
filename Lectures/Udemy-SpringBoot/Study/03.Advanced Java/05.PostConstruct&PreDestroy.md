## Advanced Java

### 05. PostConstruct / PreDestroy

---

### π“ PostConstruct / PreDestroy

`PostConstruc / PreDestroy` μ΄ λ‘μ€ μ•„μ£Ό μ¤‘μ”ν• μ–΄λ…Έν…μ΄μ…μ΄λ‹¤.
κ°„λ‹¨ν•κ² `class SomeClass` λ¥Ό λ§λ“¤μ–΄μ„ μ§„ν–‰ν•΄λ³΄μ.
μ΄ `Bean` νΉμ • ν΄λμ¤μ μΈμ¤ν„΄μ¤μ— λ¨λ“  μμ΅΄μ„±μ„ μ—°κ²°ν•λ” λ€λ΅ μ΄κΈ°ν™”λ¥Ό μν–‰ν•λ ¤ ν•λ‹¤κ³  κ°€μ •ν•΄λ³΄μ.
μλ¥Ό λ“¤μ–΄ `SomeDependency` λΌλ” μμ΅΄μ„±μ„ μ—°κ²°ν•λ‹¤κ³  μƒκ°.

```java
@Component
class SomeClass {
	private SomeDependency someDependency;

	public SomeClass(SomeDependency someDependency) {
		super();
		this.someDependency = someDependency;
		System.out.println("all dependencies are ready!");
	}

	public void Initialize() {
		someDependency.getReady();
	}
}

@Component
class SomeDependency {

	public void getReady() {
		System.out.println("Some logic using SomeDependency");
	}

}
```

μ΄λ€λ΅ μ¶λ ¥ν•΄λ³΄λ©΄ `someClass / someDependency` κ°€ λ‘λ‹¤ μ¶λ ¥ λλ‹¤
μƒμ„±μκ°€ μ‹¤ν–‰λ ν›„ μμ΅΄μ„±μ΄ μ¤€λΉ„λμ—μ„λ• `sysout` μ„ μν–‰ν•΄λ³΄μ.

![Image](https://github.com/user-attachments/assets/040e235e-4815-406d-af0e-cf5d0f8f6756)

μ¶λ ¥ κ²°κ³Όλ¥Ό λ³΄λ©΄ `sysout` λ¬Έκµ¬κ°€ λ¨Όμ € μ¶λ ¥λ μ΄ν›„μ— `Bean` μ΄ λ¨λ‘ λ‚μ—΄λλ‹¤. μ΄ νΉμ • μμ΅΄μ„±μ—μ„ `Bean` μ΄ μ¤€λΉ„λλ” λ€λ΅, μμ΅΄μ„±μ„ μ—°κ²°ν•λ” λ€λ΅ μ΄κΈ°ν™”ν•λ ¤κ³  ν•λ‹¤.
λν• `μ΄κΈ°ν™”` κ³Όμ •μ μΌλ¶€λ΅ μμ΅΄μ„±μ—μ„ νΉμ • λ©”μ†λ“λ¥Ό νΈμ¶ν•΄λ³΄μ.

#### μ΄λ• μμ΅΄μ„±μ„ μ—°κ²°ν•λ” λ€λ΅ μ΄κΈ°ν™”λ¥Ό μ‹¤ν–‰ν•λ ¤λ©΄?

μ΄λ° μƒν™©μΌ λ• `@PostConstruct` λ¥Ό μ‚¬μ©ν•λ‹¤. `Initialize` μ„μ— μ–΄λ…Έν…μ΄μ…μ„ μ‘μ„±ν•λ©΄ μμ΅΄μ„±μ΄ μ¤€λΉ„λ ν›„μ—λ” λ°”λ΅ μ΄κΈ°ν™”κ°€ λλ‹¤.

```
// @PostConsturct μ‚¬μ©μ „
all dependencies are ready!
...Bean μƒλµ
someClass
someDependency

// @PostConsturct μ‚¬μ©ν›„
all dependencies are ready!
Some logic using SomeDependency
...Bean μƒλµ
someClass
someDependency
```

μ΄μ²λΌ Springμ€ μλ™μΌλ΅ μμ΅΄μ„±μ„ μ—°κ²°ν•κ³ , μ—°κ²°ν•λ” λ€λ΅ `PostConstruct` λ¥Ό μ–΄λ…Έν…μ΄μ…ν• λ©”μ†λ“λ¥Ό νΈμ¶ν•λ‹¤.

> β… `PostConstruct`
> μ΄ μ–΄λ…Έν…μ΄μ…μ€ μ΄κΈ°ν™”λ¥Ό μν–‰ν•κΈ° μ„ν•΄ μμ΅΄μ„± μ£Όμ…μ΄ μ™„λ£λ ν›„ μ‹¤ν–‰ν•΄μ•Ό ν•λ” λ©”μ†λ“μ—μ„ μ‚¬μ©ν•λ©°, μ΄ λ©”μ†λ“λ” ν΄λμ¤λ¥Ό μ‚¬μ©ν•κΈ° μ „μ— νΈμ¶λμ–΄μ•Ό ν•λ‹¤. λ‹¤λ¥Έ `Bean` μ΄ μ΄ `Bean` μ„ μ‚¬μ©ν•  μ μκ² λκΈ° μ „μ— μ΄ λ©”μ†λ“κ°€ νΈμ¶λλ‹¤.

#### μ•±μ΄ μΆ…λ£λκΈ° μ „μ—, μ»¨ν…μ¤νΈμ—μ„ `Bean` μ΄ μ‚­μ λκΈ° μ „μ— λ¬΄μ–Έκ°€ ν•΄μ•Όν•λ‹¤λ©΄?

`PreDestroy` λ΅ ν•  μ μλ‹¤. λ³΄ν†µ μ΄ μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•΄μ„ `cleanup` μ„ μ‚¬μ©ν•λ‹¤.

> β… `PreDestroy`
> μ΄ μ–΄λ…Έν…μ΄μ…μ€ μ»¨ν…μ΄λ„μ—μ„ μΈμ¤ν„΄μ¤λ¥Ό μ‚­μ ν•λ” κ³Όμ • μ¤‘μ— μμμ„ μ•λ ¤μ£Όλ” μ½λ°±μ•λ¦ΌμΌλ΅ λ©”μ†λ“μ—μ„ μ‚¬μ©λλ‹¤. `PreDestroy` λ¥Ό μ–΄λ…Έν…μ΄μ…ν• λ©”μ†λ“λ” λ³΄μ ν•κ³  μλ λ¦¬μ†μ¤λ¥Ό ν•΄μ ν•λ”λ° μΌλ°μ μΌλ΅ μ‚¬μ©λλ‹¤.

![Image](https://github.com/user-attachments/assets/af7d62c7-dcf2-4f9c-80ea-1c55eef46662)

μ»¨ν…μ¤νΈμ—μ„ `Bean` μ΄ λ°”λ΅ μ‚­μ λκΈ°μ „μ— `sysout` μΌλ΅ μ°μ€ κ²ƒμ΄ μ¶λ ¥λ¨μ„ λ³Ό μ μλ‹¤.

#### π“μ •λ¦¬

μμ΅΄μ„±μ„ μ—°κ²°ν•λ” λ€λ΅ μ΄κΈ°ν™” λ…Όλ¦¬λ¥Ό μ‹¤ν–‰ν•λ ¤λ” κ²½μ°, μλ¥Όλ“¤μ–΄ λ°μ΄ν„°λ² μ΄μ¤λ“±μ—μ„ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ” κ²½μ°μ— `PostConstruct` λ¥Ό μ‚¬μ©ν•  μ μκ³ , μ»¨ν…μ΄λ„μ—μ„ `Bean` μ΄ μ‚­μ λκΈ° μ „μ—, application contextμ—μ„ μ‚­μ λκΈ° μ „μ— cleanupμ„ μν–‰ν•λ ¤λ” κ²½μ°μ—λ” `PreDestroy` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•  μ μλ‹¤.
