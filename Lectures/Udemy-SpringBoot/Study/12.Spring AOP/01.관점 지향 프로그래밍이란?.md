## Spring AOP

### 01. 관점 지향 프로그래밍이란?

---

### 📌 AOP의 등장 배경

![](https://velog.velcdn.com/images/bibiboy/post/09ed262f-ad5e-4ba6-9029-43a3fce869a9/image.png)

`AOP` 즉,관점 지향 프로그램이란 무엇일까?
앱은 대부분 `계층적 접근` 을 적용하는데, 예를 들어
`웹 레이어 / 비즈니스 레이어 / 데이터 레이어` 로 계층이 나뉘어져있고, 앱에 따라 층이 더 있기도하다. 각 레이어에서는 각각 관련된 것을 담당한다.

- `웹 레이어`
  `웹 레이어` 에선 뷰 관련 로직을 담당하고, 웹 애플리케이션을 개발한다면 뷰 로직은 웹 레이어에 속한다. `REST API` 를 개발한다면 `JSON을 변환하는 작업` 또한 웹 레이어에 들어가고, 모든 컨트롤러들, REST 컨트롤러들은 다 웹 레이어에 존재한다.

- `비즈니스 레이어`: 비즈니스 로직이 들어간다.
- `데이터 레이어` : 지속성 관련 기능이 들어간다. `MongoDB / MySQL` 같은걸 이용할 때 `JPA Spring Data` 나 여러 다른 프레임워크를 사용할 수 있다.

✅ 그런데 여기서 `보안` 은 공통적인 부문이다.

보안은 층과 상관없이 매우 중요하다. 성능도 있는데, 성능 측정은 각 층에 적용하고 싶을것이고, 로깅 또한 있다. 디버깅을 하려면 충분한 정보를 로깅해야 도움이 될것이다.
즉, 웹 애플리케이션 / 마이크로서비스엔 층이 여러 개 있다는 것이다.
이런 공통 부문을 `공통 관심사` 라고 한다.

#### 공통 관심사는 어떻게 구현하면 될까?

해당 기능을 레이어마다 구현하는것은 원치 않을것이다. 코드 중복이 엄청나게 될것이고, 관리하기 어려운 코드가 될것이다.
그래서 `관점 지향 프로그래밍` 줄여서 `AOP` 가 등장한다.

### 📌 AOP

![](https://velog.velcdn.com/images/bibiboy/post/1f67286b-6d2f-448e-adb3-249035344d05/image.png)

`AOP` 는 공통 관심사를 구현할 때 주로 사용하는데, AOP가 먼저 하는 작업은 `공통 관심사항` 을 `애스팩트` 로 만드는 것이다.
`로깅 / 보안 / 성능` 다 각각 하나의 애스팩트로 구현한다.
`포인트 컷` 이라는 것은 애스팩트를 어디다 적용할 것인지를 명시하는 로직을 정의한다.
로깅 애스팩트가 있다면, 적용 대상은 `비즈니스 / 데이터 / 웹` 레이어가 될것이다.

#### AOP의 구현

`AOP` 를 구현하려면 Java 세계에서 매우 유명한 프레임워크 `2개` 가 있는데,
`Spring AOP (Spring Aspect Oriented Programming)` 모듈이다.
`Spring Bean` 을 이용해 사용할 수 있고, `Spring Framework` 로 빈을 관리한다면 `Spring AOP` 를 사용할 수있다.

`Spring Bean` 으로의 메소드 호출을 인터셉트한다면 `Spring Bean` 의 해당 메소드가 호출되기 전에 인터셉트하고 특정 로직을 실행되게 할 것이다.

또한 `AspectJ` 도 있고, 완전한 `ERP 솔루션` 인데 요즘 많이 쓰지는 않는다.
좋은 점은 `유연성` 이고, 아무 `java class` 로의 메소드 호출을 인터셉트 할 수 있다.
Spring Bean이 아니여도 된다.
필드의 값이 변경될때 인터셉트할 수 있고, 클래스에 멤버 변수가 있다면 이 값이 바뀔때도 인터셉트할 수 있다.
