## Spring AOP

### 08. TrackTime 어노테이션 만들어보기

---

### 📌 TrackTime

어떤때에는 특정 메소드를 골라서 해당 메소드만 성능을 측정하고 싶을 수도 있을것이다.
이럴 땐 어노테이션을 생성하는것, 어노테이션으로 AOP를 구현할 수 있다는 점이 꽤 도움이 된다.

일단 `calculateMax` 메소드의 실행시간을 재보고 싶다.
`@TrackTime` 이라는 어노테이션을 만들고 `cmd + 1` 을 누르게 되면 이건 존재하지 않는 어노테이션이라서 `create annotation TrackTime` 이라는 구문이 나오게 된다.

`annotation` 이라는 `package` 를 만들어서 넣어주자.

> 여기서 중요한 2가지는 이 어노테이션은 `런타임에 사용` 하고 싶고, 어노테이션은 `메소드를 대상` 으로만 하게 사용하고 싶다.

일단 `@Target` 어노테이션으로 타겟을 메소드로 지정해준다.
`@Target(ElementType.METHOD)` 그리고 런타임에 실행하길 원하니 `@Retention` 을 추가해서 이 정보가 런타임에 제공되게 하기 위해 `RUNTIME` 을 넣어준다.

```java
package com.in28minutes.learn_springaop_13.annotation;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface TrackTime {

}
```

이렇게 만들어놓으면 실행 시간을 측정하고 싶은 아무 메소드에 `TrackTime` 어노테이션을 쓸 수도 있다.
이 어노테이션을 포인트컷으로도 사용할 수 있는데,

```java
@Pointcut("@annotation(/learn-springaop-13/src/main/java/com/in28minutes/learn_springaop_13/annotation/TrackTime.java")
	public void trackTimeAnnotation() {}
```

이렇게 만들어서 사용할 수 있다.
`PerformanceTrackingAspect` 에서 모든 메소드 호출을 인터셉트하는데

```java
@Around("com.in28minutes.learn_springaop_13.aspects.CommonPointcutConfig.businesAndDataPackageConfig()")
	@Around("com.in28minutes.learn_springaop_13.aspects.CommonPointcutConfig.trackTimeAnnotation()")
```

`TrackTimeAnnotation` 을 넣어줄 수 있다.

> ✅ 상황에 따라 이렇게 어떤 메소드는 로그 출력을 해주고 어떤 건 보안 관련 작업을 해주어야 할 때가 있을 수 있는데, 그런 상황에서 `커스텀 어노테이션` 을 만들고 그런 어노테이션을 이용해 `AOP` 를 구현할 수 있다.
