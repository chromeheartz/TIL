## ì¿¼ë¦¬íŠ¹ì„± 2: ë°ì´í„° ë³€í™˜ê³¼ ë°ì´í„° ë¦¬í˜ì¹­(Re-fetching)
### 30. Code Quiz / UseStaffì— ëŒ€í•œ ì„ íƒì

```ts
// utils.ts
import type { Staff } from '../../../../shared/types';

export function filterByTreatment(
  staff: Staff[],
  treatmentName: string,
): Staff[] {
  return staff.filter((person) =>
    person.treatmentNames
      .map((t) => t.toLowerCase())
      .includes(treatmentName.toLowerCase()),
  );
}
```

ê¸°ì¡´ì— êµ¬í˜„ë˜ì–´ìˆë˜ `filterByTreatment` í•¨ìˆ˜ëŠ” `ì¸ìë¡œ ë°›ì€ ë°ì´í„°`ë¥¼ ì›í•˜ëŠ” `ì¹´í…Œê³ ë¦¬ì— ë§ê²Œ ì¶œë ¥`ë˜ê²Œë” ë™ì‘í•˜ëŠ” í•„í„°ë§ í•¨ìˆ˜.

- `staff` : ì „ë‹¬ë°›ì€ ì „ì²´ ë°ì´í„°
- `treatmentName` : ì „ë‹¬ ë°›ì€ ë°ì´í„° ì† ë°ì´í„°ì˜ ì¢…ë¥˜
ì „ë‹¬ë°›ì€ treatmentNameì˜ ì¢…ë¥˜ì— ë”°ë¼ ì¶œë ¥ë˜ëŠ” ë°ì´í„°ê°€ ë³€ê²½ëœë‹¤.
ì˜ˆë¥¼ë“¤ì–´, treatmentNameìœ¼ë¡œ Massageê°€ ì˜¤ë©´ Massageë§Œ í•˜ëŠ” staff ë°ì´í„°ê°€ ì¶œë ¥ë˜ê³ , Scrubì´ ì˜¤ë©´ Scrubë§Œ í•˜ëŠ” staff ë°ì´í„°ê°€ ì˜¨ë‹¤.

### ğŸ“Œ êµ¬í˜„

```tsx
// useStaff.tsx (ì»¤ìŠ¤í…€í›…)
export const useStaff = (): UseStaff => {
  const [filter, setFilter] = useState('all');

  const selectFn = useCallback( // 2ï¸âƒ£
    (unfilterdStaff) => filterByTreatment(unfilterdStaff, filter),
    [filter],
  );

  const { data: staff = fallback } = useQuery(queryKeys.staff, getStaff, {
    select: filter !== 'all' ? selectFn : undefined, // 1ï¸âƒ£
  });

  return { staff, filter, setFilter };
}
```

1ï¸âƒ£ **filterì˜ ìƒíƒœê°’ì´ allì´ë¼ë©´**.

ì¦‰, ì•„ë¬´ filteringì´ ì‘ë™ë˜ì§€ ì•Šì€ ì „ì²´ë°ì´í„°ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²½ìš°ì—ëŠ” ì•„ë¬´ëŸ° ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ì§€ ì•Šì•„ë„ ë¨ìœ¼ë¡œ `undefined`.

2ï¸âƒ£ **filterì˜ ìƒíƒœê°’ì´ allì´ ì•„ë‹ˆë¼ë©´**.

ì¦‰, filtering ê¸°ëŠ¥ì´ ë™ì‘í•œë‹¤ë©´ `selectFn í•¨ìˆ˜` ê°€ ì‹¤í–‰ë˜ê³ , ì´ë•Œ ì¸ìë¡œ `useQueryë¡œ ë°›ì€ ë°ì´í„°` ì™€ `filter ìƒíƒœê°’` ì´ ì „ë‹¬ëœë‹¤.

`useCallback`ì„ ì‚¬ìš©í•˜ì—¬ Select í•¨ìˆ˜ì— ë³€ë™ì´ ì—†ìœ¼ë©´ selectí•¨ìˆ˜ë¥¼ ì¬ì‹¤í–‰í•˜ì§€ ì•Šê²Œ ë§Œë“¤ì–´ `ìµœì í™”`

#### ë°ì´í„° ì¢…ë¥˜ê°€ ë³€ê²½ë˜ëŠ” ì›ë¦¬ëŠ” ì‹¤ì œë¡œ í™”ë©´ì— ë³´ì´ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ Radioíƒœê·¸ë¥¼ í†µí•´ ì¹´í…Œê³ ë¦¬ë¥¼ í´ë¦­í•  ê²½ìš° í´ë¦­í•œ ê°’ì— ë”°ë¼ ë³€ê²½ë˜ëŠ” ê²ƒì´ë‹¤.