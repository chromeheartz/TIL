## React Queryì™€ ì¸ì¦
### 38.useQueryë¥¼ ìœ„í•œ localStorageì˜ initialData

#### Recap

`onSuccess` ì½œë°±ì„ í†µí•´ ë°ì´í„°ë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì²˜ë¦¬í–ˆë‹¤. 
`ì¿¼ë¦¬ í•¨ìˆ˜` ì—ì„œ ë°ì´í„°ê°€ `ì—…ë°ì´íŠ¸` ë˜ê±°ë‚˜ `setQueryData` ì—ì„œ ë°ì´í„°ê°€ `ì—…ë°ì´íŠ¸` ë  ë•Œë§ˆë‹¤ í˜¸ì¶œ. ì–´ëŠ ìª½ì´ë˜ ì½œë°±ì´ ì‹¤í–‰ë˜ë©° `ì‚¬ìš©ìž ì œê±° / ì‚¬ìš©ìž ìž¬ì„¤ì •` ìœ¼ë¡œ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ê°€ ì—…ë°ì´íŠ¸ ëœë‹¤.

**ì—¬ê¸°ì„œ ë¡œê·¸ì¸ í›„ì— íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ë„ ë¡œê·¸ì¸ì„ ìœ ì§€í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ **

> íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œ ê³ ì¹¨í•  ë•Œì™€ ê°™ì´ `useQuery` ê°€ `ì´ˆê¸°í™”` ë¥¼ ì‹¤í–‰í•  ë•Œ ì´ ë°ì´í„°ê°€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì •ì˜ë˜ì–´ ìžˆëŠ”ì§€ í™•ì¸í•´ì•¼í•œë‹¤.

### ðŸ“Œ Setting Initial Value

useQueryì—ì„œ `initialData` ì˜µì…˜ì„ ì‚¬ìš©
- initialDataëŠ” `ì´ˆê¸° ë°ì´í„°` ë¥¼ `ìºì‹œì— ì¶”ê°€` í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
 - ê¸°ì¡´ì— íŽ˜ì´ì§€ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šê²Œ í•˜ë ¤ë©´ `ì´ˆê¸°ê°’ì´ í•„ìš”í•œ ë•Œ` ë„ ìžˆì—ˆë‹¤. `useTreatments / useStaff` ì—ì„œ ë°°ì—´ì„ ë°˜ë³µí•˜ëŠ” ê²½ìš°. ë¹ˆ ë°°ì—´ì„ `fallback` ìœ¼ë¡œ ë„£ì–´ì£¼ì—ˆë˜ ê²ƒ.`placeholderData` ì˜µì…˜ìœ¼ë¡œë„ ê°€ëŠ¥í•˜ì§€ë§Œ ë‘ ê²½ìš° ë‹¤ `ìºì‹œì— ì¶”ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤`.
- ì‹¤ì œ ì‚¬ìš©ìžì˜ ë°ì´í„°ê°€ `ë¡œì»¬ ìŠ¤í† ë¦¬ì§€` ì— ìžˆìœ¼ë‹ˆ ê°€ì ¸ì™€ì„œ ì´ˆê¹ƒê°’ì„ ìž¡ì•„ì¤€ë‹¤.

[`broadcastQueryClient`] ë¼ëŠ” ê²ƒìœ¼ë¡œ `ì¿¼ë¦¬ ìºì‹œ ë°ì´í„°` ë¥¼ `ë¸Œë¼ìš°ì €ì— ìœ ì§€` í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì„ React-Queryì—ì„œ ì œê³µí•˜ì§€ë§Œ. í˜„ìž¬ ê¸°ì ìœ¼ë¡œ `ì‹¤í—˜ì ` ì¸ ë‹¨ê³„ì´ê¸°ë•Œë¬¸ì— ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¥¼ í†µí•´ `ë°ì´í„° ë³´ì¡´` êµ¬í˜„.

**ì¿¼ë¦¬ë¥¼ `ì´ˆê¸° ë°ì´í„°` ë¡œ ë¯¸ë¦¬ ì±„ìš°ê¸° [`docs`]**

#### êµ¬í˜„

ì´ˆê¸° ë°ì´í„°ê°€ í•„ìš”í• ë•Œë§ˆë‹¤ `getStoredUser` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ì´ í•¨ìˆ˜ëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ `JSON í˜•ì‹ì˜ ë°ì´í„°` ë¥¼ ê°€ì ¸ì™€ì„œ ê°ì²´ë¡œ êµ¬ë¬¸ë¶„ì„ì„ í•œë‹¤. 
ì´ë ‡ê²Œ ê°„ë‹¨í•˜ê²Œ ìƒˆë¡œê³ ì¹¨ì‹œì— useQuery ì´ˆê¸°í™”ë¥¼ ì´ˆê¸°ê°’ìœ¼ë¡œ ë„£ì–´ì£¼ëŠ” ê²ƒì„ í•  ìˆ˜ ìžˆë‹¤.

```tsx
// useUser.ts
const { data: user } = useQuery(queryKeys.user, () => getUser(user), {
  initialData: getStoredUser,
  ...
});
  
// user-storage/index.ts
export function getStoredUser(): User | null {
  const storedUser = localStorage.getItem(USER_LOCALSTORAGE_KEY);
  return storedUser ? JSON.parse(storedUser) : null;
}
```


[`broadcastQueryClient`]: https://tanstack.com/query/v4/docs/react/plugins/broadcastQueryClient

[`docs`]: https://tanstack.com/query/latest/docs/react/guides/initial-query-data?from=reactQueryV3&original=https%3A%2F%2Ftanstack.com%2Fquery%2Fv3%2Fdocs%2Fguides%2Finitial-query-data#using-initialdata-to-prepopulate-a-query