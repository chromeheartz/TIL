## ì¿¼ë¦¬íŠ¹ì„± 1: í”„ë¦¬í˜ì¹­(Pre-fetching)ê³¼ pagination
### 25. useAppointments Custom Hook
---------------------------------------------

### ğŸ“Œ useAppointments

`Appointments` ëŠ” ì˜ˆì•½ë‚´ì—­ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ì¸ë° ì œì¼ ë§ì€ ë¡œì§ì´ ë“¤ì–´ê°€ìˆë‹¤.
ë¡œì§ì„ í•œë²ˆ ì •ë¦¬í•˜ê³  useQuery ì‘ì„±ì„ í•´ë³´ì.

Gridì—ì„œ ë‚ ì§œê°€ ë‹¨ìˆœíˆ ë°˜ë³µë˜ëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆëŠ”ë° ë§¤ë‹¬ì˜ `ì²« ë²ˆì§¸ ë‚ `ì€ ìš”ì¼ì— ë§ê²Œ ë°°ì¹˜ë˜ì–´ì•¼í•´ì„œ `<DateBox>` ë¡œ ë Œë”ë§í•´ì£¼ê³  ë‚˜ë¨¸ì§€ ë‚ ë“¤ì€ `[...Array(...)]` êµ¬ë¬¸ìœ¼ë¡œë¶€í„° ë°˜ë³µë˜ì–´ ë Œë”ë§ëœë‹¤.
ê·¸ë¦¬ê³  ê° ë‚ ì§œë¥¼ ë©ˆì¶œìˆ˜ ìˆë„ë¡ `lastDate`ê°€ í•„ìš”í•˜ë‹¤

```tsx
// Calendar.tsx
<Grid templateColumns="repeat(7, 1fr)" gap={4} my={5} mx={10}>
  {/* first day needs a grid column */}
  <DateBox
    date={1}
    gridColumn={monthYear.firstDOW + 1}
    appointments={appointments[1]}
    />
  {/* the rest of the days will follow */}
  {[...Array(monthYear.lastDate)].map((_, i) =>
	i > 0 ? (
	  <DateBox key={i} date={i + 1} appointments={appointments[i + 1]} />
	) : null,
   )}
</Grid>
```

ğŸ“ `useAppointments` í›…ì—ëŠ” í˜„ì¬ `ì„¸ ê°€ì§€ ì—­í• ` ì´ ìˆë‹¤.

- 1ï¸âƒ£ í˜„ì¬ ì›”ê³¼ ì—°ë„ë¥¼ ì¶”ì . ì´ê²ƒì„ ì‚¬ìš©ìê°€ ì„ íƒí•œ `monthYear` ë¡œ ì§€ì •. monthYearì„ `ì—…ë°ì´íŠ¸` í•˜ëŠ” ë°©ë²•ë„ í•„ìš”í•˜ë‹¤. ì´ì „ë‹¬, ë‹¤ìŒë‹¬ë¡œ ì§€ì •í• ë•Œ ì»´í¬ë„ŒíŠ¸ê°€ í›…ì— ì•Œë¦¬ëŠ” ë°©ë²•ì´ ìˆì–´ì•¼ í•˜ê¸° ë•Œë¬¸
- 2ï¸âƒ£ í•´ë‹¹ `monthyear` ì— ëŒ€í•œ `appointments(ì˜ˆì•½)` ì„ ë°˜í™˜. 
  -  `ì´ì „ / ë‹¤ìŒ` ë‹¬ì˜ ë°ì´í„°ë¥¼ `preFetching`
- 3ï¸âƒ£ `í•„í„°` ìƒíƒœë¥¼ ì¶”ì . ìº˜ë¦°ë”ì—ì„œ ì˜ˆì•½ëœ ë‚ ì§œë¥¼ í¬í•¨í•´ `ëª¨ë“  ë‚ ì§œë¥¼ í‘œì‹œ / ì˜ˆì•½ë˜ì§€ ì•Šì€ ë‚ ì§œë§Œ í‘œì‹œ` í•  ìˆ˜ ìˆëŠ” í•„í„°ë§ ì—­í• 
    

```ts
// useAppointments.ts

// @ts-nocheck
import dayjs from 'dayjs';
import { Dispatch, SetStateAction, useState } from 'react';

import { axiosInstance } from '../../../axiosInstance';
import { queryKeys } from '../../../react-query/constants';
import { useUser } from '../../user/hooks/useUser';
import { AppointmentDateMap } from '../types';
import { getAvailableAppointments } from '../utils';
import { getMonthYearDetails, getNewMonthYear, MonthYear } from './monthYear';

// for useQuery call
async function getAppointments(
  year: string,
  month: string,
): Promise<AppointmentDateMap> {
  const { data } = await axiosInstance.get(`/appointments/${year}/${month}`);
  return data;
}

// types for hook return object
interface UseAppointments {
  appointments: AppointmentDateMap;
  monthYear: MonthYear;
  updateMonthYear: (monthIncrement: number) => void;
  showAll: boolean;
  setShowAll: Dispatch<SetStateAction<boolean>>;
}

export function useAppointments(): UseAppointments {
  
  /** ****************** START 1: monthYear state *********************** */
  const currentMonthYear = getMonthYearDetails(dayjs());
  const [monthYear, setMonthYear] = useState(currentMonthYear);
  function updateMonthYear(monthIncrement: number): void {
    setMonthYear((prevData) => getNewMonthYear(prevData, monthIncrement));
  }
  /** ****************** END 1: monthYear state ************************* */
  
  /** ****************** START 2: filter appointments  ****************** */
  const [showAll, setShowAll] = useState(false);
  const { user } = useUser();
  /** ****************** END 2: filter appointments  ******************** */
  
  /** ****************** START 3: useQuery  ***************************** */
  const appointments = {};

  /** ****************** END 3: useQuery  ******************************* */

  return { appointments, monthYear, updateMonthYear, showAll, setShowAll };
}
```