## MSWë¡œ ì„œë²„ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸°

### 08. í…ŒìŠ¤íŠ¸ì—ì„œ ì„œë²„ ì—ëŸ¬ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸°
---------------------------------------------

### ðŸ“Œ Server Errors

`í…ŒìŠ¤íŠ¸` ë¥¼ ìž‘ì„±í•´ì„œ ì„œë²„ì—ì„œ ì—ëŸ¬ ì‘ë‹µì„ ë°›ì•˜ì„ ë•Œ `ê²½ê³ ì°½` ì´ ë‚˜íƒ€ë‚˜ëŠ”ì§€ í™•ì¸

#### OrderEntry ì»´í¬ë„ŒíŠ¸

ì´ ì»´í¬ë„ŒíŠ¸ëŠ” `Scoops / Toppings` ì— ëŒ€í•´ ì˜µì…˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ 2ë²ˆ ë Œë”ë§í•œë‹¤.
í…ŒìŠ¤íŠ¸ì—ì„œ ì´ 2ê°€ì§€ì— ëŒ€í•œ `ì—ëŸ¬` ë¥¼ ë°˜í™˜í•˜ê³  ê²½ê³ ì°½ ë°°ë„ˆê°€ ë‚˜íƒ€ë‚˜ë„ë¡ êµ¬í˜„.
ê·¸ëž˜ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œìž‘í•˜ê¸° ìœ„í•´ `OrderEntry` ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë†“ê³  ì§„í–‰.

### ðŸ“Œ OrderEntry.test.jsx

ì´ íŒŒì¼ì—ì„œëŠ” `ê²½ê³ ì°½ ë°°ë„ˆ` ê°€ ë‚˜íƒ€ë‚˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í• ê²ƒì´ë‹¤.

- ì¼ë°˜ í…ŒìŠ¤íŠ¸ íŒŒì¼ ì„¤ì •ìœ¼ë¡œ `render, screen` ì„ ê°€ì ¸ì˜¨ë‹¤.
- ê·¸ë¦¬ê³  ë Œë”ë§í•  `OrderEntry` ë˜í•œ ê°€ì ¸ì˜´

â­ï¸ ìŠ¤ì¿± / í† í•‘ ë¼ìš°íŠ¸ì— ê´€í•œ ì—ëŸ¬ë¥¼ ë°˜í™˜í•  `msw` ë¥¼ ì„¤ì •í•´ì•¼ í•œë‹¤.
`setupTest.js` ì—ì„œ ì„¤ì • ë°©ì‹ì„ ì‚´íŽ´ë³´ê²Œë˜ë©´

- `/mocks/server.js` ì—ì„œ ì„œë²„ë¥¼ ê°€ì ¸ì™”ê³  í•´ë‹¹ ì„œë²„ë¥¼ ë¦¬ìŠ¤ë‹í–ˆê³ ,
- ê° í…ŒìŠ¤íŠ¸ í›„ì— í•¸ë“¤ëŸ¬ë¥¼ ìž¬ì„¤ì •í–ˆê³ , ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ì—ëŠ” ì„œë²„ë¥¼ ë‹«ì•˜ë‹¤.

âœ… `handlers.js` ì— ìžˆëŠ” í•¸ë“¤ëŸ¬ê°€ `ê¸°ë³¸ í•¸ë“¤ëŸ¬` ì¸ë°, ì´ í•¸ë“¤ëŸ¬ë¥¼ `ì˜¤ë²„ë¼ì´ë“œ` í•  ê²ƒì´ë‹¤.
ì˜¤ë²„ë¼ì´ë“œí•  ìƒˆ í•¸ë“¤ëŸ¬ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ `í…ŒìŠ¤íŠ¸ íŒŒì¼` ì—ì„œ `rest` ë¥¼ `msw` ì—ì„œ ê°€ì ¸ì˜¤ê³  ìƒˆ í•¸ë“¤ëŸ¬ë¥¼ ìƒì„±í•˜ë„ë¡ í•œ ë’¤ `server` ë„ ê°€ì ¸ì™€ì„œ í•¸ë“¤ëŸ¬ì— ê²¹ì³ì“°ëŠ”ê²ƒìœ¼ë¡œ êµ¬í˜„.

#### ì–´ë–»ê²Œ ì˜¤ë²„ë¼ì´ë“œí• ê¹Œ?

`resetHandlers` ë¼ëŠ” ë©”ì†Œë“œë¥¼ ì‚¬ìš©.
ì´ í•¸ë“¤ëŸ¬ëŠ” `í•¸ë“¤ëŸ¬` ë¥¼ ê¸°ë³¸ ì¸ìˆ˜ë¡œ ì·¨í•˜ê³  ì„œë²„ì—ê´€í•œ `ì—”ë“œí¬ì¸íŠ¸ê°€ ìžˆëŠ” ëª¨ë“  í•¸ë“¤ëŸ¬` ë¥¼ ìž¬ì„¤ì •í•œë‹¤.
ì´ì œ í•¸ë“¤ëŸ¬ë¥¼ ìž¬ì„¤ì •í•˜ê³  2ê°œì˜ ì¸ìˆ˜ë¥¼ ì œê³µ.

- ì²« ë²ˆì§¸ í•¸ë“¤ëŸ¬ëŠ” `ìŠ¤ì¿±ì— ê´€í•œ ì—ëŸ¬` ë¥¼ ë°˜í™˜. ì„œë²„ëŠ” `3030` ì—ì„œ ì‹¤í–‰ì¤‘ì´ê³  ìž¬ì„¤ì •í•˜ë ¤ëŠ” ì—”ë“œí¬ì¸íŠ¸ëŠ” `scoops`. `resolver` ë¡œ ì—ëŸ¬ ìƒíƒœë¥¼ ë°˜í™˜í• ê²ƒì¸ë° `(req, res, ctx) => res(ctx.status(500)` ì´ ëœë‹¤.
- ë‘ ë²ˆì§¸ í•¸ë“¤ëŸ¬ë„ ë§ˆì°¬ê°€ì§€ë¡œ `toppings` ë¡œ ì„¤ì •.

#### â­ï¸ ì—¬ê¸°ì„œ ì‚¬ìš©í•  ì¿¼ë¦¬ë¥¼ ì„ íƒí•  ë•Œ ì¤‘ìš”
- ë°”ë¡œ ë‚˜íƒ€ë‚ ê²ƒì´ë¯€ë¡œ `get` ì„ ì‚¬ìš©í•´ì•¼ í• ê¹Œ? 
- ë°”ë¡œ ë‚˜íƒ€ë‚˜ì§€ ì•Šì„ê²ƒì´ë¯€ë¡œ `query` ë¥¼ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?
- ë¹„ë™ê¸°ì‹ì´ë¼ `find` ë¥¼ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?

í˜„ìž¬ëŠ” ê²½ê³ ì°½ì´ ë¹„ë™ê¸°ì‹ì¼ ê²ƒìœ¼ë¡œ ì˜ˆìƒí•œë‹¤. `Axios` ì—ì„œ `catch` í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œê¹Œì§€ ê²½ê³ ì°½ì´ ë‚˜íƒ€ë‚˜ì§€ ì•Šê¸° ë•Œë¬¸.
`findAllBy` ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° ì´ë¥¼ ìœ„í•´ `async / await` ë¥¼ ì¶”ê°€.

```jsx
import { render, screen } from "@testing-library/react";
import OrderEntry from "../OrderEntry";
import { rest } from "msw";
import { server } from "../../../mocks/server";

test("handles error for scoops and toppings routes", async () => {
  server.resetHandlers(
    rest.get("http://localhost:3030/scoops", (req, res, ctx) =>
      res(ctx.status(500))
    ),
    rest.get("http://localhost:3030/toppings", (req, res, ctx) =>
      res(ctx.status(500))
    )
  );

  render(<OrderEntry />);

  const alerts = await screen.findAllByRole("alert", {
    name: "An unexpected error ocurred. Please try again later.",
  });

  expect(alerts).toHaveLength(2);
});

```