## MSWë¡œ ì„œë²„ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸°

### 01. Mock Service Workerì™€ í•¸ë“¤ëŸ¬
---------------------------------------------

### ðŸ“Œ Mock Service Worker

#### `Mock Service Worker(MSW)` ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

- ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œì„ ê°€ë¡œì±„ì„œ ì§€ì •ëœ ì‘ë‹µì„ ë°˜í™˜í•´ì•¼ í•˜ëŠ”ë°, ì´ë•Œ `ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸` ë§Œ ìˆ˜í–‰í•œë‹¤. ì´ í…ŒìŠ¤íŠ¸ì—ëŠ” ë³´í†µ ì„œë²„ê°€ í¬í•¨ë˜ì§€ ì•ŠìŒ
- í…ŒìŠ¤íŠ¸í•˜ëŠ” ë™ì•ˆ ë°œìƒí•˜ëŠ” ëª¨ë“  `ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ` ì„ ë§‰ì„ê²ƒì´ë‹¤.
- ì„œë²„ ì‘ë‹µì— ê¸°ë°˜í•œ `í…ŒìŠ¤íŠ¸ ì¡°ê±´` ë„ ì„¤ì •í•˜ëŠ”ë° ì´ë ‡ê²Œ ë  ê²½ìš° `ì„œë²„ê°€ ì˜µì…˜ìœ¼ë¡œ ë¬´ì—‡ì„ ë°˜í™˜í•˜ëŠëƒ` ì— ë‹¬ë ¤ìžˆë‹¤.
  - ì„œë²„ê°€ `xxxë¼ëŠ” ì‘ë‹µ` ì„ ë³´ë‚´ë©´ íŽ˜ì´ì§€ì—ëŠ” ì–´ë–»ê²Œ ë‚˜íƒ€ë‚´ì•¼ í• ê¹Œ? ë¥¼ í…ŒìŠ¤íŠ¸í•¨
  
> **MSW DOCS ðŸ‘‰ [`msw docs`]**
  
#### setup

```
npm install msw
```

`CRA` ì— ë‹¬ë ¤ì˜¤ì§€ ì•Šìœ¼ë‹ˆ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜ í•œ í›„ì— ì¶”ê°€ë¡œ ë¬´ì—‡ì„ í•´ì•¼í• ê¹Œ?
- `í•¸ë“¤ëŸ¬` ë„ ìƒì„±.
  - `íŠ¹ì •í•œ URL` ê³¼ `ë¼ìš°íŠ¸` ì— ë¬´ì—‡ì„ ë°˜í™˜í• ì§€ ê²°ì •í•˜ëŠ” í•¨ìˆ˜
- ìš”ì²­ì„ ì²˜ë¦¬í•  `í…ŒìŠ¤íŠ¸ ì„œë²„` ë¥¼ ìƒì„±.
- í…ŒìŠ¤íŠ¸í•˜ëŠ” ë™ì•ˆ í…ŒìŠ¤íŠ¸ ì„œë²„ê°€ í•­ìƒ `ìˆ˜ì‹  ëŒ€ê¸° ì¤‘` ì¸ì§€ `í˜¸ì¶œì„ ê°€ë¡œì±„ê³  ìžˆëŠ”ì§€` í™•ì¸í•´ì•¼í•œë‹¤.

### ðŸ“Œ Mock Service Worker Handler

> **Mocking REST API DOCS ðŸ‘‰ [`Mocking REST API`]**

ì„œë²„ëŠ” `REST API ì„œë²„` ì´ê¸° ë–„ë¬¸ì— ê´€ë ¨ ë¬¸ì„œë¥¼ í™•ì¸.
`src/mocks` í´ë”ì— handlers.js ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ê³  `msw` ë¥¼ `import`.
ì´í›„ ë¬¸ì„œë¥¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ë©´ í•¸ë“¤ëŸ¬ëŠ” `rest.post / rest.get` ë©”ì„œë“œì˜ `ë°°ì—´` ì´ë¼ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìžˆë‹¤.

```js
// src/mocks/handlers.js
import { rest } from 'msw'
```

#### ðŸ“ rest.post / rest.get

```js
rest.get('http://localhost:3030/scoops', (req, rest, ctx) => {})
```
í•¸ë“¤ëŸ¬ë¥¼ ë¶„ì„í•´ë³´ìž
- `rest` : ìš°ì„  í•¸ë“¤ëŸ¬ íƒ€ìž…ì„ ì§€ì •í•œë‹¤ `REST / graphQL` ì´ë“  `MSW` ì—ì„œ ê°€ì ¸ì˜´
- `get` : íŠ¹ì • URLì— ëª¨ì˜í•˜ë ¤ëŠ” ë©”ì†Œë“œ `get / post / delete / patch`
- `http://localhost...` : ëª¨í‚¹í•  ì „ì²´ `URL`
- `(req, res, ctx) => {}` : ì‘ë‹µ ë¦¬ì¡¸ë²„ í•¨ìˆ˜ê°€ì˜¤ëŠ”ë° ì´ í•¨ìˆ˜ëŠ” `ìš”ì²­ ê°ì²´ / ì‘ë‹µ ê°ì²´ / ì‘ë‹µì„ êµ¬ì¶•í•˜ëŠ” ìœ í‹¸ë¦¬í‹°ì¸ ì»¨í…ìŠ¤íŠ¸` ë¡œ ì´ë£¨ì–´ì§„ë‹¤.

#### ðŸ“ sundae-server

> **sundae-server GITHUB ðŸ‘‰ [`sundae-server`]**

í•´ë‹¹ ê¹ƒí—™ì„ ë“¤ì–´ê°€ë³´ë©´ `sundae-server` ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìžˆë‹¤.
ì˜ˆì‹œë¡œ í•˜ë‚˜ë¥¼ í™•ì¸í•´ë³´ë©´ `server.js` ì— `/scoops` ë¼ìš°íŠ¸ê°€ getê³¼ í•¨ê»˜ ìžˆëŠ”ë° ì´ í•¨ìˆ˜ëŠ” `sundaeOptions.iceCreamFlavors` ë¥¼ ë°˜í™˜í•œë‹¤. 
`sundae-Options.json` íŒŒì¼ì—ì„œ ì½ì–´ ë“¤ì´ëŠ” ëª¨ë“  JSONì„ íŒŒì‹±.

```js
// sundae-Options.json
{
  "iceCreamFlavors": [
    {
      "name": "Mint chip",
      "imagePath": "/images/mint-chip.png" 
    },
    {
      "name": "Vanilla",
      "imagePath": "/images/vanilla.png" 
    },
    {
      "name": "Chocolate",
      "imagePath": "/images/chocolate.png" 
    },
    {
      "name": "Salted caramel",
      "imagePath": "/images/salted-caramel.png" 
    }
  ], 
  "toppings": [
    {
      "name": "M&Ms",
      "imagePath": "/images/m-and-ms.png"
    },
    {
      "name": "Hot fudge",
      "imagePath": "/images/hot-fudge.png"
    },
    {
      "name": "Peanut butter cups",
      "imagePath": "/images/peanut-butter-cups.png"
    },
    {
      "name": "Gummi bears",
      "imagePath": "/images/gummi-bears.png"
    },
    {
      "name": "Mochi",
      "imagePath": "/images/mochi.png"
    },
    {
      "name": "Cherries",
      "imagePath": "/images/cherries.png"
    }
  ]
}
```

`iceCreamFlavors` ëŠ” ê°ì²´ì˜ ë°°ì—´ë¡œ ìžˆê³ , ê°ê° `name / imagePath` ë¥¼ ê°€ì§€ê³  ìžˆìŒ.
ì´ì œ `MSW` ì—ì„œ `ì‘ë‹µì„ ë°˜í™˜í•  ë•Œ` ì–´ë–¤ê²ƒì„ `ëª¨ë°©` í•´ì•¼í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìžˆë‹¤.


#### ðŸ“ handlers.js

ëŒì•„ì™€ì„œ `handlers` íŒŒì¼ì„ ìž‘ì„±.
ì „ì²´ URLì„ ìž…ë ¥í•˜ëŠ”ë° ì•„ë¬´ë°ë„ ìž…ë ¥í•˜ì§€ ì•Šì•˜ìœ¼ë‹ˆ `localhost` ë¡œ í•´ì£¼ê³ , ë¼ìš°íŠ¸, ë¦¬ì¡¸ë²„ í•¨ìˆ˜ë¥¼ ìž‘ì„±í•˜ë©´ ì‘ë‹µì„ ë°˜í™˜í•´ì¤„ ê²ƒì´ë‹¤.
ì‘ë‹µì— í•„ìš”í•œ `ì»¨í…ìŠ¤íŠ¸` ëŠ” `JSON` ë°°ì—´ì„ ê°€ì§ˆê²ƒã…‡ã„´ë°, í•´ë‹¹ ë°°ì—´ì€ ì„œë²„ì˜ ì‹¤ì œ ì‘ë‹µê³¼ ê°™ì€ ê°ì²´ë¥¼ ê°€ì§€ê²Œ êµ¬í˜„.

```js
// src/mocks/handlers.js
import { rest } from 'msw'

export const handlers = [
  rest.get('http://localhost:3030/scoops', (req, res, ctx) => {
    return res(
      ctx.json([
        { name: 'Chocolate', imagePath: '/images/chocolate.png' },
        { name: 'Vanilla', imagePath: '/images/vanilla.png' }
      ])
    )
  })
]
```

[`sundae-server`]: https://github.com/bonnie/udemy-TESTING-LIBRARY/tree/main/sundae-server
[`Mocking REST API`]: https://mswjs.io/docs/getting-started/mocks/rest-api
[`msw docs`]: https://mswjs.io/