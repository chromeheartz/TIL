## Utility Container

### 03. 컨테이너에서 명령을 실행하는 다양한 방법

---

### 📌 컨테이너에서 명령 실행하기

`docker run node` 로 노드 이미지를 실행해보자.
`nnode` 는 도커 허브의 공식 이미지인데, 실행하게되면 시작하자마자 중단된다.
왜냐면 `-it` 인터렉티브 모드에서 시작해야 하는 이미지 이기때문이다. 그래야 입력받기를 기다린다. `docker run -it node`

인터렉티브 모드로 시작하면 몇몇 기본 명령을 실행할 수 있는데, 계산기처럼 사용할 수도 있고 다른 노드 명령을 실행할 수도 있다. 하지만 일단 노드 컨테이너를 이렇게 시작할 수 있다는 점을 알아두자.

`cmd + c` 를 눌러서 종료할 수 있는데, 그렇게 되면 컨테이너 또한 종료가 된다.
이 node 컨테이너를 `-it, -d` 두가지 모드로 실행할것인데, 즉 명령을 입력할 수는 없지만 내부적으로 이 컨테이너는 입력을 기다리고 있으므로 계속 실행될것이다.

따라서 실행 중인 컨테이너 리스트에서 `docker ps` 를 해보면 자동 할당된 컨테이너이름을 찾아볼 수 있는데, 여기서 사용해보지 않은 명령을 사용해보자.

#### docker exec

> ✅ `docker exec` 명령을 사용하면 이 컨테이너가 실행하는 기본 명령 외에 실행 중인 컨테이너 내에서 특정 명령을 실행할 수 있다. 따라서 Dockerfile에 지정되어 있는 명령 외에 입력된 특정 명령을 실행한다.

즉, 애플리케이션은 계속 실행중인 상태에서 컨테이너 내에 추가적인 명령을 실행할 수 있다.
이것은 때때로 유용할 수 있는데 `exec` 명령을 사용하려면 실행 중인 컨테이너의 이름이 필요하다.

일단 노드 컨테이너에 프로젝트를 생성하는 `npm init` 을 실행해보자.
`docker exec optimistic_almeida npm init`
해당 형식으로 실행할 수 있는데, 즉시 끝나게 된다. `run` 과 마찬가지로 `exec` 는 인터렉티브 모드에서 시작되어야만 한다. 구동하여 프로세스에 계속 연결되고 입력을 제공하려면.

따라서 `run` 과 마찬가지로 `exec` 에 `-it` 플래그를 추가해서 실행해보자.
`docker exec -it optimistic_almeida npm init`
이렇게 하면 초기 생성하는 것처럼 질문을 받게 된다. 이것은 로컬 시스템에 `node / npm` 을 설치하지 않고도 명령을 실행할 수 있다는 것을 의미한다. 컨테이너 내부에서 실행되기 때문.

> 하지만 현재는 유용하지 않은데, 이유는 컨테이너에 프로젝트가 있다면 터미널로 생성할 수 있지만 접근은 할 수 없기 떄문이다. 일단은 실행중인 컨테이너에서도 프로젝트를 설치할 수 있다는 것만 인지하자.

컨테이너가 시작될 때 시작되는 디폴트 명령을 중단하지 않고, 실행 중인 컨테이너에서 명령을 실행할 수 있다. 하지만 디폴트 명령을 오버라이드 할 수도 있다.

`node` 컨테이너를 시작할 대 컨테이너에서 실행되는 디폴트 명령은 `node 실행 파일` 그 자체인데, 그것은 명령을 실행할 수 있는 인터렉티브 모드로 진입할 수 있다.
즉, `node run -it node` 가 디폴트 명령이며 이것을 시작하면 노드 이미지가 실행된다.

그리고 인터렉티브 모드를 사용하면 연결 상태를 유지하며 인터렉티브 node 입력 모드로 작업할 수 있는것이다.

이미지 이름 뒤에 새 명령을 추가하여 디폴트 명령을 오버라이드 할 수 있는데 `npm init` 을 사용해서 오버라이드 해보자.

![](https://velog.velcdn.com/images/chromeheartz/post/d166c761-5bcf-4dbc-8f33-9d40a6da83e6/image.png)

그렇게 되면 구성 설정을 물어보는 프롬프트를 얻게 되는데 enter키를 누르면 작업이 완료 될것이다. 그러므로 그 후에 컨테이너도 중지된다. `npm init` 명령을 사용하여 노드 인터렉티브 모드로 실행해서 디폴트 명령이 오버라이드 되었기 때문.
`npm init` 명령으로 프로젝트를 생성하고 프로젝트가 종료되면 중지된다.
지금은 전혀 유용하지 않은데 도커가 제공하는 기능을 알고 있는 것도 중요하다.

> ✅ 예를 들어 `docker exec` 는 메인 프로세스를 중단하지 않고 컨테이너 내부에 작성된 로그 파일을 읽을 때 유용하다.
