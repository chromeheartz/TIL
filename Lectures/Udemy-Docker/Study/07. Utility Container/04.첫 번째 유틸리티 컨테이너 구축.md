## Utility Container

### 04. 첫 번째 유틸리티 컨테이너 구축

---

### 📌 첫 번째 유틸리티 컨테이너

유틸리티 컨테이너를 만들려면 자체 이미지가 필요하기 때문에 `Dockerfile` 을 추가해보자.
`node` 의 조금 더 슬림한 운영체제 레이어를 사용하는 `14-alpine` 을 사용할것이다.

작업 디렉토리를 `/app` 으로 설정할것이다.
이 컨테이너와 이미지에서 실행되는 명령에 의해 사용할 폴더를 정의하는 것이고, `docker run` 으로 입력한 명령이 포함되며 이미지 이름 뒤에 입력하는 모든 항목도 디폴트 작업 디렉토리에서 실행된다. 그래야 시작 명령을 지정할 수 있기 때문
`npm init` 시작 명령을 지정해주자.

하지만 이 이미지를 init 명령만 실행되도록 제한하고 싶지 않고, 사용자에게 이미지에 대한 모든 권한을 부여하고 이미지에 대한 모든 명령을 실행할 수 있도록 하고 싶다.

```dockerfile
FROM node:14-alpine

WORKDIR /app

CMD npm init
```

일단 이렇게 저장하고, 빌드를 해보자.

노드 유틸리티를 연습하고 있으니 `node-util` 태그를 지정하고 실행.
`docker build -t node-util . `
이후 `docker run` 으로 이미지에 `npm init` 을 전달하고 실행해보자.
`docker run -it node-util npm init`
연결상태를 유지하여 값을 입력할 수 있도록 인터렉티브 모드로 시작.

디폴트로 명령들은 `app` 폴더에서 실행된다.

### 📌 미러링

그것들을 로컬 폴더에 미러링하고자 한다.
즉, 컨테이너에서 생성한 것들을 호스트 머신에서도 사용할 수 있게 되는데, 컨테이너의 도움으로 호스트 머신에서 프로젝트를 생성할 수 있다.

⭐️ 호스트 머신에 모든 부가 도구를 설치하지 않고도 호스트 머신에 영향을 미치는 것을 실행하는데 유틸리티 컨테이너를 사용할 수 있는것이다.

그 기능을 사용하기 위해 `-v` 로 바인드 마운트를 사용할것이다.
그리고 지금 내 폴더를 작업 디렉토리에 바인딩할 수 있다.
dockerfile의 경로를 복사해서 파일이름을 제거하고 콜론을 붙여서 컨테이너 내부 경로인 `/app` 을 지정한다.

`docker run -it -v /Users/bibi/Documents/GitHub/TIL/Lectures/Udemy-Docker/Code/07-utility-container:/app node-util npm init`

이렇게 시작을 하게 되면 프로젝트 설정을 하게 된다. 프로젝트 이름을 `test` 로 만들고 터미널에서 프롬프트를 다 확인해보면, 컨테이너가 시작된다.
완료가 된 후에 `package.json` 을 확인해보면 `test` 로 내가 컨테이너에서 설정했던 값들 / 프로젝트들이 설정이 되고 있는 것을 볼 수 있다.

바인드 마운트로 인해 `호스트 머신의 폴더` 를 `컨테이너 내부의 폴더` 와 공유하는 것이다.
그리고 공유 폴더 내부의 컨테이너 내부에서 실행하는 명령은 호스트 머신에도 영향을 미친다.
이렇게 되면 호스트 머신에서 `node / npm` 을 완전히 `uninstall` 할 수 잇게 되는것이다.

이게 뭔가 이상하게 보일 수도 있지만, 실제로 컴퓨터에 부가 도구를 설치할 필요가 없다는 것이 유용하다. `node` 는 사실 괜찮은데 `Laravel / PHP` 같은 경우에는 훨씬 더 복잡해진다.
