## Data & Volume

### 13. Docker 볼륨 관리하기

---

### 📌 Docker 볼륨 관리

이제 볼륨을 사용하는 이유, 언제 어떤 타입의 볼륨을 사용하는지 언제 바인드 마운트를 사용하는지 명확해졌다.

볼륨은 `도커` 에 의해 관리된다고했었다.
컨테이너를 실행할 때 `-v` 플래그를 사용하면 도커는 볼륨을 생성한다. 이는 호스트 시스템의 어딘가에 자동으로 폴더를 생성한다는 의미이기도한데, 부가적인 명령을 제공하지 않으며 작업을 수행한다.

그럼에도 불구하고 내부를 살펴보고 도커가 실제로 수행한 작업을 볼 수 있다.
`docker volume --help` 를 통해 확인해보면 몇 가지 명령들이 있다.
이 명령어로 도커가 관리중인 모든 볼륨을 살펴볼 수 있다.

`ls` 명령으로 현재 활성화 중인 볼륨을 모두 리스팅할 수 있다.

> 📍 `바인드 마운트` 는 이 리스트에 표시되지 않는다. 도커에 의해 관리되는 볼륨이 아니기 때문이다.
> 로컬 폴더를 컨테이너 내부의 폴더에 바인딩하기 때문에, 호스트 머신의 알려진 폴더이며 도커는 이를 제어하지 않는다.

도커에 의해 관리된다는 것은 컨테이너를 실행할 때 볼륨이 존재하지 않으면 `생성` 한다는 의미이기도하다.
`docker volume create` 를 사용하여 자체적인 볼륨을 생성할 수도 있다.
명명된 볼륨으로 생성해놓고 컨테이너를 실행할때 `-v feedback-files:/app/feedback` 으로 볼륨을 사용할 수도 있다.

`docker volume` 명령으로 볼륨들을 제어할 수 있다는 점을 아는 것은 가치가 있다.
이 명령으로 더 많은 작업을 수행할 수 있다.

하나의 볼륨을 제거하거나 사용하지 않는 모든 로컬 볼륨을 제거할 수도 있고, 볼륨을 `검사` 할 수도 있다.

`docker volume inspect feedback` 으로 볼륨을 조사해보자.

![](https://velog.velcdn.com/images/chromeheartz/post/37f7336a-a780-422b-a35d-efbb7450328a/image.png)

언제 볼륨이 생성되었는지, 사용된 드라이버가 어떤건지 중요한건 아니지만 그래도 옵션들을 볼 수 있다.
`Mountpoint` 도 볼 수 있는데, 이것은 실제로 데이터가 저장되는 호스트 머신상의 경로이다.
하지만 이것은 내 시스템에서 찾을 수 있는 경로가 아니다.
실제로 이것은 시스템 상에 도커가 설정한 `작은 가상 머신 내부` 에 있기 때문이다.

호스트 머신 파일 시스템에 있는 실제 경로가 아닌, 가상 머신은 다시 다르게 매핑되기 때문에 볼륨이 저장되어 있는 위치를 찾기 어렵다고 한것이다.

`docker volume rm` 으로 볼륨을 제거할 수 있다.
하지만 사용중이고 해당 볼륨을 기반으로 활성화된 컨테이너가 있다면, 컨테이너를 머저 중지해야 볼륨을 제거할 수 있다.

> ✅ 볼륨을 제거하면 그 안의 모든 데이터가 손실된다.
> 이후 동일한 이름의 볼륨을 생성하더라도 당연히 데이터를 다시 가져오진 못한다.
