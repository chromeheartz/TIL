## Data & Volume

### 01. 데이터 카테고리/다양한 종류의 데이터 이해하기

---

### 📌 데이터

다양한 데이터 종류가 있다. 어떤 데이터 종류의 데이터를 가지고 있는지 이해해야 우리가 직면할 수 있는 문제와 해결할 문제들을 이해할 수 있다.

일단 앱이 있다. 이는 소스 코드와 앱이 실행되는 환경이다.
`package.json` 파일에 지정된 종속성같은 일부 써드파티 패키지를 사용할 수도 있다. 하지만 전반적으로 설정하고 작성한 코드 패키지를 가지게 된다.

이후 코드와 전체 환경이 빌드 단계에서 이미지에 추가된다.
즉, 이미지를 빌드할 때 코드가 이미지에 복사된다. 이러한 명령을 설정하기 위해 `Dockerfile` 을 사용했다.

그리고 이미지를 기반으로 컨테이너를 실행할 때 그 컨테이너는 제공된 환경에서 내 코드를 사용한다.
이미지에 복사되었으므로 해당 코드는 고정된다. 이미지가 빌드되면 변경될 수 없는것.

> ✅ 이들 데이터, 소스 코드 및 이와 관련된 모든것을 이미지에 복사하면 더이상 변경할 수 없다.
> 이미지는 `읽기 전용` 이기 때문에 모든 명령 실행이 완료되면 이미지가 잠겨서 닫히므로 이미지를 다시 빌드해야 한다. 즉, 무언가를 변경하려면 새 이미지를 빌드해야 한다.

기존 이미지로 가서 변경을 시작할 수 없다. 이게 문제가 되지 않는 이유는 애플리케이션 코드와 환경은 읽기 전용이야 하기 때문이다. 이것이 이미지에 저장하는 이유이다.

실행 중인 앱은 소스 코드 편집을 해서는 안된다.

이게 지금까지 다룬 데이터의 종류이다.
이에 더불어 `2가지` 다른 종류의 데이터가 있다.

#### 임시 애플리케이션 데이터

> 📌 예를 들어 `임시 애플리케이션 데이터` 가 있다. 이것은 소스 코드를 의미하는 것이 아니라 `앱이 실행되는 동안 생성된 데이터` 를 의미한다.

예를 들어, 웹 사이트의 경우 사용자가 `입력폼` 에 무언가를 입력하고 그 데이터를 가져와서 서버에서 실행 중인 컨테이너로 처리하는데 입력된 그 사용자 데이터가 `임시 데이터` 이다.
코드의 변수에 저장할 수 있으므로 결국 `메모리에만 저장` 되거나 혹은 `DB / 파일` 에 저장될 수도 있다. 하지만 컨테이너가 종료될 때 그 데이터를 잃어도 `일시적인 데이터` 이기 때문에 상관은 없을것이다.

임시 데이터는 `read-write` 이기 때문에 이미지가 아닌 컨테이너에 저장된다.
이미지는 읽기 전용이기 때문. 그리고 이미지가 아닌 컨테이너에 저장된다는 것은 `부가(extra) 레이어` 에 대해 이야기하는 것인데, 이미지 위에 도커에 의해 추가된 것이다.

이 레이어는 실제로 그 컨테이너를 구성하고, 부가 레이어는 기본적으로 로직이라 할 수 있는데, 이미지를 인식하고 이미지의 파일 시스템을 인식하며, 복사하지 않고 파일 시스템을 미러링하는 로직이다.

하지만 이것은 부가적인 사항이고, 도커는 실제로 `read-write` 권한을 가지며 파일의 시스템을 조작할 수 있다. 이미지에서 변경하지 않고, 부가 레이어에서 변경한다.

그리고 효율적인 방식으로 관리되는것이, 컨테이너의 변경 사항을 추적하고 이미지의 파일시스템을 가져와 최종 파일 시스템을 파생시켜 `read-write` 레이어에 저장된 변경 사항과 결합시킨다.

결국, 컨테이너에 저장하라고하면 컨테이너는 이 정보를 저장하며 파일이 무엇이든 간데 `read-write 레이어` 에 저장하거나 도움을 받아 저장한다.
이것들은 모두 컨테이너안에 있고, 로컬 머신에는 없는 것이다.

#### 제3의 데이터

`영구 애플리케이션 데이터` 를 말한다.
예를 들어 한 앱이 있는데, 사용자가 등록하면, 자신을 잠그는 앱이라고 가정해보자.
사용자 계정을 받아서 파일에 저장하거나 일반적인 데이터베이스에 저장한다. 물론 그 데이터는 지속되어야 하고, 실행 중인 컨테이너에서 데이터를 가져와 생성한다.

따라서 컨테이너의 실행 중인 앱의 데이터는 저장되어야 한다.
컨테이너가 중지되고 다시 시작되더라도 데이터는 그대로 있어야 하기 때문이다.

앱의 새버전을 배포하려고 컨테이너를 중지하고 새 버전을 배포해도 데이터가 손실되어서는 안된다.

> ✅ 즉, 컨테이너가 종료될 때 손실되지 않아야 하는 데이터를 말한다.

컨테이너에 저장할때 `볼륨` 의 도움을 받게 될것이다.
