## Data & Volume

### 14. COPY 사용 vs 바인드 마운트 사용

---

### 📌 COPY / 바인드 마운트

여기서 한가지 질문이 있다.
`docker run` 명령으로 컨테이너를 실행하면 전체 폴더를 바인드 마운트로 바인딩하여 코드 변경 사항이 실행 중인 컨테이너에 자동으로 반영된다.

#### 그런데도 `Dockerfile` 의 모든 항목을 여전히 `COPY` 하는 이유는 무엇일까?

즉, 바인드 마운트로 전체 폴더를 볼륨으로 사용하는데 이미지가 생성될 때 이 스냅샷에서 복사하는 이유는 무엇일까? 어차피 덮어쓰게 되는데.
그렇다면 이 COPY단계를 제거할 수 있을까?
`COPY package.json .`

결론부터 말하자면 주석처리하고 이미지를 리빌드하고 컨테이너를 실행해보면 여전히 잘 작동하는 것을 알 수 있다. 즉, 바인드 마운트를 사용하면 COPY를 제거할 수 있다.

#### 중요한 사항

바인드 마운트에 대해 잊지 말아야할 중요한 사항이 있다.
`docker run` 명령은 개발 중에 사용하는 명령이다. 개발 중에 이 바인드 마운트를 사용하여 코드의 변경 사항을 실행 중인 컨테이너에 즉시 반영한다.
개발을 마친 뒤에는 실제로 이 컨테이너를 가져와 서버에 넣는데, 이 때 `바인드 마운트` 로 실행하지 않을 것이다.

데이터가 유지되도록 다른 볼륨을 사용할 수 있지만 로컬 폴더랑 이어주는 바인드 마운트는 사용하지 않게 된다. 컨테이너가 서버상의 제품 상태로 실행 중이라면, 실행되는 동안 실시간으로 업데이트되는 연결된 소스 코드가 없기 때문에, 프로덕션 환경 즉, 실제로 제품을 사용하는 환경에서는 `코드의 스냅샷` 을 가지고 있어야한다.

> ✅ 그렇기 때문에 `COPY` 명령을 유지해서 스냅샷 이미지를 만들도록 한다.
> 개발 중에 바인드 마운트를 원한다면 사용해도 되지만, 프로덕션용 스냅샷 컨테이너를 생성하는 옵션은 반드시 필요하다. 컨테이너를 배포하는 방법에서 자세히 알아보자.
