## Docker Image & Container

### 11. Attached & Detached 컨테이너

---

### 📌 Attached & Detached

이제 `docker 명령` 으로 더 자유롭게 할 수 있는 일들이 많아졌따.
컨테이너를 처음 시작할 떄의 모드로 돌아가보자. 다시 시작하면 터미널의 프로세스가 즉시 완료된다. 터미널의 실행 중인 도커 컨테이너에 더이상 연결하지 않는것이다.
![](https://velog.velcdn.com/images/chromeheartz/post/41aa978d-0639-408e-b68d-61525ce3b78c/image.png)

그럼에도 `docker ps` 로 볼 수 있듯이 여전히 실행중이다.
터미널에서 우리를 차단하지 않을 뿐이고, `docker run` 과는 다르다.
`docker run -p 8000:80 0aa8d6c86771` 으로 같은 이미지를 사용하여 실행해보면 두 개의 컨테이너가 실행되는 것을 볼 수 있다. 하지만 터미널을 보게되면 더 이상의 명령을 입력할 수 없다. 타이핑은 되도 실행시킬 수 없다.
![](https://velog.velcdn.com/images/chromeheartz/post/9d5b2a49-7281-4d25-a4fa-4bf5d80a1476/image.png)
이 프로세스는 터미널을 차단하고 있지만 `docker start` 는 그렇지 않다. (컨테이너는 포어그라운드에서 실행중)

`attached(연결) / detached(분리)` 모드를 내가 원하는 대로 설정할 수 있다.

- `docker start` 로 시작하는 경우 `detatched` 모드가 디폴트이며
- `docker run` 으로 시작하는 경우 `attached` 모드가 디폴트이다

#### 이것이 왜 중요할까?

`localhost:8000` 의 `detached` 모드로 시작된 컨테이너이므로 콘솔에 아무것도 표시되지 않는다.

![](https://velog.velcdn.com/images/chromeheartz/post/1ebc15e4-25ad-4afc-b564-067c5b8e0921/image.png)

`docker start` 로 킨 4000 포트는 goal을 입력해도 콘솔에 아무것도 나오지 않지만,
`docker run` 으로 시작한 8000 포트의 경우는 goal에 입력을하면 콘솔에도 나오게 된다.

> 즉, `attached` 모드는 단순히 우리가 그 컨테이너의 출력결과를 수신한다는 것을 의미한다.
> 예를 들어 콘솔에 출력되는 내용들. 원하든 원하지않든

`detached` 모드에서 컨테이너를 실행할 수 있다.
[IMAGE_ID] 앞에 `-d` 플래그를 추가하여 `detached` 모드로 실챙하면 새로운 컨테이너ID를 얻게 된다. 이렇게 하면 콘솔에 안나오게 된다. 분리되어있기 때문

분리된 컨테이너를 다시 연결할 때는 `docker container attach [CONTAINER_NAME]` 을 해주면 된다. 만약 컨테이너가 실행중일때 해당 명령어를 다시 쓰게되면 터미널이 연결이되고 goal에 입력을 해주면 다시 터미널로 들어오는 것을 볼 수 있다.

또한 `docker logs` 명령은 컨테이너에 출력된 로그를 가져올 수 있다.![](https://velog.velcdn.com/images/chromeheartz/post/dba7bbb9-b6a3-4f85-8f52-0444faba6ec5/image.png)

`docker start` 로 분리되어 시작했어도 `docker logs` 를 살펴보면 컨테이너에 출력되는 로그들을 가져올 수 있다. 또한 `-f` 를 추가하여 `follow` 모드로 진입해서 계속 수신 대기 할 수도 있다.

![](https://velog.velcdn.com/images/chromeheartz/post/eb220f01-2c37-4c3c-a01d-5da98c9d1040/image.png)
