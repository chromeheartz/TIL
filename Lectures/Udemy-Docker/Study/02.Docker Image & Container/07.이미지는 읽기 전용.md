## Docker Image & Container

### 07. 이미지는 읽기 전용

---

### 📌 읽기 전용

커스텀 이미지를 빌드하고, 이미지를 기반으로 첫 번째 컨테이너도 실행해보았다.
이제 `Dockerfile` 과 도커 명령 및 여기에서 실행할 수 있는 하위 명령에 대해 배울 수 있는 방법이 더 있다.

구성에 대한 모든 다양한 방법.
일단 이미지와 컨테이너가 작동하는 방식과 함께 그를 완전히 이해하는 것이 중요하다. 예를 들어 노드 앱 코드에서 코드를 변경하고 싶다고 해보자.
HTML을 살짝 바꾼다고 가정해보자.

따라서 이 작은 변경사항에 대해서 명령을 다시 실행하여 앱을 이미지 기반으로 컨테이너를 다시 시작하면 노드 앱이 시작이 된다. 하지만 여기서 문제점은
내가 코드를 바꾼 변경사항이 반영되지 않았다는 것이다.

#### 변경사항이 반영되지 않은 이유는 무엇일까?

컨테이너를 다시 시작하기도 했는데, 왜 바뀌지 않았을까.
📍 이미지가 작동하는 방식을 이해해야한다.
소스 코드인 노드 앱 코드의 일부임을 이해해야한다. 이 코드로 도커 파일을 통해서 컨테이너 파일 시스템에 보관하는 `server.js` 파일을 포함하여 프로젝트 폴더 내의 모든 것을 app폴더에 정확하게 복사하도록 지시한다.
그런 다음 `npm install -> port 열기` 형식으로 서버를 시작하고 있는데,

> ✅ 소스 코드를 이미지에 복사하고 기본적으로 `복사한 시점` 에서 소스 코드의 `스냅샷` 을 만든다.

따라서 업데이트된 소스 코드를 새 이미지로 복사하려면 이미지를 `다시 빌드` 해야 한다.
코드를 변경해야 할 때마다 이미지를 다시 작성해야 한다는게 지금은 번거롭고 이상하게 들릴 수 있지만 이후에 다른 방법을 해볼것이다.

일단 핵심은 `이미지는 기본적으로 잠겨있고 빌드되면 끝` 이라는 것이다.
이미지의 모든 것이 읽기 전용이며 과거에 해당 코드를 복사했기 때문에 코드를 업데이트하여 외부에서 편집할 수 없었던 것이다.

업데이트된 모든 코드를 기본적으로 이미지에 복사하려면 이미지를 다시 빌드해야 한다. 따라서 `docker build .` 을 실행하여 이미지를 결국 다시 빌드해야 한다는 것이다.

새로운 이미지를 빌드하고 실행해보면 코드 변경사항이 적용되었음을 알 수 있다.
이미지가 결국 `닫힌 템플릿` 이라는 것을 이해해야한다.
