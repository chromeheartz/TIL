## Docker Image & Container

### 16. 컨테이너에&컨테이너로 부터 파일 복사하기

---

### 📌 파일 복사하기

컨테이너를 살펴보고 싶거나, 컨테이너에 무언가를 추가하거나 이미 실행 중인 상태에서 무언가를 추출하고싶다면 어떻게 해야할까?
이에 대한 명령이 있다.

#### cp

복사를 의미하는 `cp` 명령인데, 실행 중인 컨테이너로 또는 실행 중인 컨테이너 밖으로 파일 또는 폴더를 복사할 수 있다.
예를 들어 로컬 호스트 프로젝트 폴더에 어떤 폴더를 만들었다고 가정해보자. `dummy/test.txt` 이렇게 있다고 가정해보자.

`docker cp dummy/.` 우선 다른 위치에 복사하려는 폴더나 파일을 지정하자. dummy 폴더 안의 전부를 복사하려고 지정하고 이후에 복사 작업의 목적지를 쓰면 된다.
즉, 어디로 복사하려는지 그 경로를 말한다.

당연히 도커는 복사할 컨테이너를 알아야 하기 때문에 컨테이너 이름이 필요하다.
`docker cp dummy/. [CONTAINER_NAME]:/test` 콜론을 넣고 복사하려는 컨테이너의 내부 경로를 지정해준다.

이렇게 실행하게 되면 컨테이너 내부의 test내부에 복사될것이다.

#### 어떻게 볼 수 있을까?

일단 로컬의 dummy 폴더를 삭제한 이후에
`docker cp [CONTAINER_NAME]:/test/test.txt dummy` 이렇게 첫 번째 인수는 컨테이너와 경로를 넣고 두 번째 인수는 로컬 폴더로 넣게되면 컨테이너에서 로컬로 복사해서 가져오는것을 알 수 있다. 따라서 컨테이너에 제대로 파일이 들어가있는 것을 알 수 있다.

> ✅ 결국 `cp` 명령으로 로컬 호스트 머신과 실행 중인 컨테이너 간에 파일을 복사할 수 있다.

이 명령은 컨테이너를 다시 시작하고, 이미지를 다시 작성하지 않고도 컨테이너에 무언가를 추가할 수 있다.
소스 코드가 변경되었다고 가정하면, 일반적으로 이미지를 다시 빌드하고 컨테이너를 다시 시작해야 했지만 그냥 변경된 코드를 컨테이너에 복사할 수도 있다.
📍 하지만 오류가 발생하기 쉽기 떄문에, 일반적으로 잘 하지 않는다.

또한 `server.js` 파일처럼 현재 실행 중인 파일을 교체하는 것도 실제로 불가능하다.
따라서 파일을 컨테이너에 복사하는 것은 좋은 해결책이 아니다.

> 대신 이후에 이미지를 다시 빌드하지 않고 컨테이너에서 코드를 업데이트 하는 방법을 알아보자.

#### 그럼 언제 사용할 수 있을까?

컨테이너가 많은 로그 파일을 생성하는 경우 `docker cp` 명령을 사용하여 이러한 로그 파일을 컨테이너에서 로컬 호스트 시스템으로 복사할수도 있다.
그러면 로그 파일에 직접 접근할수도 있고, 평소에는 볼 수 없었던 컨테이너의 `블랙박스` 를 볼 수 있게 된다.
