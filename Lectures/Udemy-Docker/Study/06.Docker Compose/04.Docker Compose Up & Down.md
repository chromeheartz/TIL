## Docker Compose

### 04. Docker Compose Up / Down

---

### 📌 Up / Down

이제 문제는 도커 컴포즈로 서비스를 시작하는 방법이다.
해당 도커 컴포즈 파일이 있는 폴더로 이동해서 하나의 명령만 해주면 된다.
`docker-compose up`
그러면 이 컴포즈 파일에서 찾을 수 있는 모든 서비스가 시작된다.
그리고 그것은 단지 컨테이너를 시작할 뿐만 아니라 필요한 모든 이미지를 가져와 빌드한다.

`docker image prune -a` 을 실행하여 모든 이미지를 제거하고, 실행해보자.
또한 `docker container prune` 또한 실행하여 중지된 모든 컨테이너를 제거하고, 실행중인 컨테이너가 없는 상태에서 진행해보자.

`docker-compose up` 을 실행해보면 상당히 많은 것들이 출력되는 것을 볼 수 있다.
network도 자체적으로 만들고 프로젝트 폴더이름도 가져가고, 데이터 볼륨을 생성하고 그 이름을 `docker-complete_data` 이런식으로 프로젝트 폴더 이름의 접두사를 붙이는 것을 볼 수 있다. 그런 다음 그 서비스의 수신을 시작하는데 디폴트로 `attached` 모드에서 시작된다.

`cmd + c` 로 모든것을 종료할 수 있는데, 컨테이너가 중지되는 것을 알 수 있다.
`attached` 모드에서 시작하지 않으려면 `docker-compose up -d` 를 실행하여 `detached` 모드에서 시작할 수 있다. 그렇게하면 제어권을 나에게 넘길것이다.

`docker-compose down` 을 실행하게 되면, 모든 컨테이너가 삭제되고 생성된 디폴트 네트워크와 모든 것이 종료된다. 그러나 볼륨은 삭제되지 않는다. 볼륨을 삭제하려면 `-v` 플래그를 추가해야 한다.

> ✅ `-v` 를 사용하여 볼륨을 제거하는데, 여기에는 많은 의미가 있다.
> 일반적으로 볼륨과 함께 데이터를 유지하기를 원하기 때문. 볼륨을 삭제하고 서비스를 중단시키는 것은 옳지 않다.

- `docker-compose up` 은 빌드를 위한것
- `docker-compose down` 은 중지를 위한것. 모든 컨테이너를 중지하고 제거등을 한다.
