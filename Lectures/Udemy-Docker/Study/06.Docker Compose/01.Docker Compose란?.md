## Docker Compose

### 01. Docker Compose란?

---

### 📌 Docker Compose란 무엇이며 왜 사용하는가?

이전에는 여러 컨테이너를 결합하여 하나의 애플리케이션을 빌드했다.
그 앱은 `node, react, mongodb` 로 구성되어 있는데, 서로 다른 방식으로 컨테이너들이 통신했었다. 물론 영구 데이터 / 라이브 소스 코드 업데이트 등과 같은 부가 기능도 추가했다.

여기서 문제점이 있는데, 설정들을 실행하기 위해 해야하는 도커 명령들이 있다.
네트워크를 만들고 mongodb 컨테이너를 시작하고 노드 API 이미지를 빌드하고, 백엔드 컨테이너를 실행하고 ...

이런식의 작업을 수행하는데, 간단히 말해서 해야할 일이 많다.
여기서 `Docker Compose` 라는 도구를 사용할 수 있다.

> ✅ `Docker Compose`
> 다중 컨테이너 설정을 더 쉽게 관리할 수 잇게 해주고, 설정 프로세스를 자동화하는데 도움이 된다. 또한 단 하나의 명령으로 모든 것을 제거할 수 있다.

#### Docker Compose

도커 컴포즈는 `docker build / docker run` 명령을 대체할 수 있는 도구이다.
하나의 `docker build` 명령이나 하나의 `docker run` 명령이 아닌 `다수의 docker build / docker run` 을 단 하나의 구성 파일로 가진다

모든 서비스 모든 컨테이너를 즉시 시작하고, 필요하다면 모든 필요한 이미지를 빌드하는 `Orchestration set` 이다.

결국 하나의 명령을 사용하여, 모든 것을 중지하고 중단할 수 있다.
도커 컴포즈로 누구와도 공유할 수 있는 명확히 정의된 언어를 사용하는 `구성(configuration)` 파일을 가지기 때문이다.

이 구성 파일을 활용한 `단 하나의 명령` 으로 전체의 다중 컨테이너 애플리케이션을 시작하거나 중단할 수 있다. `단일 컨테이너` 에서도 도커 컴포즈를 사용할 수 있다.
하지만 다중 컨테이너에 유용하다. 많은 부가 명령과 시간을 절약할 수 있기 때문.

> ⭐️ 도커 컴포즈는 `커스텀 이미지를 위한 dockerfile` 을 대체하지 않는다.
> 또한 이미지나 컨테이너를 대체하지 않는다. 같이 작업하는 것을 더 쉽게 만들며 컨테이너를 더 쉽게 시작할 수 있게 한다.

또 중요한 것은 도커 컴포즈는 다수의 호스트에서 다중 컨테이너를 관리하는데는 적합하지 않다.
`하나의 동일한 호스트에서 다중 컨테이너` 를 관리하는데 적합한 것이다.
이후에 `단일 및 다중 호스트` 에 컨테이너를 배포하는 것도 알아보자.

#### 어떻게 시작할까?

항상 `도커 컴포즈 파일` 을 작성하는 것으로 시작한다. 터미널에서 명령을 실행하는 것이 아니다. 이 파일에는 몇 가지 핵심 사항 즉, `멀티 컨테이너 애플리케이션` 을 구성하는 핵심 구성 요소를 정의하면 된다. 컴포즈 파일에서 정의할 수 있고 정의해야하는 핵심이자 가장 중요한 요소 항목은 `📍 서비스(service)` 라 불리는 것이다.
이는 결국 다중 컨테이너 애플리케이션을 구성하는 컨테이너라고 할 수 있다. 여기서 서비스라고 하는것이 실제로 컨테이너를 의미하는 것이다.

게시해야 하는 포트를 정의하고, 환경 변수를 정의할 수 있고, 할당해야 하는 볼륨정의 및 네트워크도 할당할 수 있다. 즉, 터미널에서 도커 명령으로 할 수 있는 모든 것을 도커 컴포즈에서 할 수 있다.
