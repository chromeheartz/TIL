## Express.js

### 14. 정적으로 파일 서비스하기

---

### 📌 정적 파일 서비스

기존에 html에 css를 작업했을때는 `style` 코드를 넣어서 작업했었다.
이제 `외부 css 파일` 을 사용해보자.

문제는 지금 당장은 이를 쉽게 임포트 할 수 없다. 일반적으로 어딘가에 css 파일이 있고 앱이 서비스될때 이를 가리키게 된다. 새로운 하위 폴더를 만들고 원하는대로 명명하면 된다. 그러나 관행적으로는 `public` 이라고 부른다. 대중에게 항상 공개되는 내용을 담고 있는 폴더임을 나타내기 위해서이다.

> `액세스에 권한이 필요하지 않다` 는 뜻으로 이는 매우 중요하다.
> 모든 파일을 사용자들이 액세스할 수는 없다.

예를 들어 `views/shop.html` 에 들어가려고 하면 작동하지 않는다.
Express는 이를 받아서 일치하는 라우트를 찾으려고 한다. 하지만 예외로 특정 요청이 파일 시스템애 엑세스가 가능하도록 할 수 있다. `shop.html` 을 예로 들면 html에서 link를 사용해서 `href="/css/main.css` 로 만들어줄 수 있다. 기존에 있던 스타일은 `css` 폴더를 만들어서 파일을 만들어준다.

`<link rel="stylesheet" href="/css/main.css">`
이렇게 만들면 파일 시스템에 액세스하지 못해 파일을 찾을 수 없다고 나온다.
`public` 이 아니니 경로가 잘못되었다고 할 수도 있는데, 해당 경로를 써주더라도 작동하지 않는다.

이를 구현하려면 **정적 서비스** 라는 `express.js` 가 제공하는 기능이 필요하다. 파일을 정적으로 서비스하는 기능이다. `정적` 이란 의미는 `express.Router` 나 다른 미들웨어 소프트에서 처리되지 않고 파일 시스템으로 `직접 포워딩` 된다는 뜻이다.

이를 위해 `app.use` 로 새로운 미들웨어를 등록한다.

#### app.use(express.static(path.join(\_\_dirname, 'public')));

`express.static` 객체 자체를 사용하면 이것이 임포팅하는 객체이고 `static` 으로 내장된 메소드를 사용하면 된다. 이로 인해 정적 파일을 서비스 해줄 수 있고 이 함수를 실행해주기만 하면 된다.
바로 `읽기 액세스` 를 허용하고자 하는 폴더이다.
이후에 `path.join` 으로 경로를 구축하고 `dirname` , `public` 으로 `public` 폴더에 대한 액세스를 허용해주면 된다.

이렇게 하면 사용자가 `public` 경로에 액세스할 수 있으며 이를 저장한 다음 `shop.html` 을 확인해보면 동작을 한다. 이렇게 경로를 지정해주면 자동으로 `public` 폴더로 포워딩해주기 때문에 `href="/css/main.css` 해당 부분에서 `public` 이 필요가 없다.
