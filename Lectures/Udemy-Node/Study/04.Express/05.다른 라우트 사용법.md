## Express.js

### 05. 다른 라우트 사용법

---

### 📌 다른 라우트 사용법

다양한 라우트 즉 `url` 을 처리해보자.
일단 미들웨어를 하나 만들것인데, 해당 미들웨어는 오직 `/` 로 가는 요청에 대해서만 작동해야 한다.
이러한 요청을 어떻게 `필터링` 할 수 있을까?
`use` 함수에는 `여러 버전` 이 존재한다. 마우스를 메소드 위에 올려보면 `overloads` 에 대해서 몇가지 방법이 다름을 볼 수 있다.

![](https://velog.velcdn.com/images/chromeheartz/post/37bd51aa-316a-4663-a16c-77a8a2cd0bc5/image.png)

`API reference` 에 들어가면 `app.use` 항목에 대한 설명이 나와있다.
경로 형태의 첫 인수가 있고, 이게 찾고 있는 대상이다.
이 `path` 를 통해 특정 요청만을 걸러낼 수 있는데, 이전의 `if` 문과는 다르게 작동한다.

다음은 `callback` 인데 이는 실행해야 하는 함수이다.
콜백은 `하나 이상` 이 있을 수 있으며 원하는 만큼 가능하고 여기에 `다중 경로 필터` 를 설정할 수도 있다.

`app.use("/", () => {})` 형태로 작성하면 된다.
첫 path에 들어가는 경로에 맞춰서 적어주면 된다. 여기서 주의해야할 부분은 만약 `add-product & /` 이 두가지를 걸러낼려고할때 `/` 에 해당하는 미들웨어는 제일 하단에 넣어주어야 한다.

`/` 는 `/ & /add-product` 모두에 적용되기 때문이다.
요청이 파일위에서부터 아래로 내려가고 `next` 를 호출하지 않으면 `다음 미들웨어로 넘어가지 않기 때문` 이다.
따라서 먼저 도달하는 미들웨어에서 호출하기 때문에 내가 원하는대로 동작하지 않게 되는 것이다.

> 📍 `응답` 을 보내려고 한다면 `next` 를 호출하지 않는 것이 좋다.
> `Vanillla Node.js` 에서처럼 다른 응답 관련 코드를 실행하면 안되기 때문이다. 하나 이상의 응답을 보내려고하면 오류가 발생하게 된다.
