## Node Basic

### 12. Node 모듈 시스템 사용

---

### 📌 모듈 시스템

코드를 조금 고쳐보자.
한 파일만해도 많은 코드가 있는데 보통은 여러 파일을 작업하게 될것이다. `url 확인` 등의 작업을 하는 라우팅 로직을 포함한 새 파일을 `routes.js` 라는 이름으로 만들어보자.

`app.js`에서 server 콜백함수안에 들어있는 것들을 빼서 route.js에 옮겨주자.
`routes.js` 에서 `requestHandler` 라는 함수를 생성해서 `http.createServer` 함수를 대체하게 해주자.
이제 핸들러를 내보내기만 하면 되는데 `2가지 방법이 있다`

#### 내보내기

- 가장 아래에 `module.exports` 를 추가하는 것이다. Node.js에 의해 전역으로 노출된 키워드 혹은 객체로 내보내기 속성이 있어서 `requestHandler` 등의 값을 지정하면 함수를 가진 상수가 `module.exports` 에 저장 된다. 노출된 전역객체이기 때문에 `require` 로 `routes.js` 를 불러오면 된다.
  `const routes = require("./routes")` 로 불러오게 되면 `routes.handler` 이런식으로 사용할 수 있다.

```js
// module.exports = requestHandler;
```

- 여러 내용을 한꺼번에 내보내기 하는 경우 `객체` 형태로 만들어서 내보낼 수 있다. 이런 형태로 내보내면 객체로 받아서 사용할 수 있다.

```js
module.exports = {
  handler: requestHandler,
  someText: "Some hard coded text",
};
```

- 이 외에도 이런방식으로도 내보낼 수 있다.

```js
exports.handler = requestHandler;
exports.someText = "Some hard coded text";
```

- `module` 을 생략하고 `exports`만 입력해도 된다. Node.js에 의해 특별히 지정된 단축키이다.

```js
exports.handler = requestHandler;
exports.someText = "Some hard coded text";
```

`Node.js` 의 모듈 시스템에서 한 가지 중요한 점은 `파일 내용의 캐시가 저장` 되고 `외부에서 수정할 수 없다` 는 것이다. 만약 `routes` 를 객체로 정의하고 새로운 속성을 추가하려고하면 원본 파일을 조작할 수 없다.

> ✅ 즉, 잠금 되어 외부가 접근할 수 없기 때문에 외부에서 읽을 수 있는 내용만 내보내기 할 수 있는 것이다. 내보내는 함수가 내부적으로 변경사항을 만들 수는 있다.
