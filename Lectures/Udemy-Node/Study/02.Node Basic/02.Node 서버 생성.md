## Node Basic

### 02. Node 서버 생성

---

### 📌 Node.js 서버 생성

![](https://velog.velcdn.com/images/chromeheartz/post/aa863e82-3a6a-49ad-9883-a83650004268/image.png)

일단 `01-node-basic` 폴더를 만들어서 `server.js / app.js` 같은 이름으로 만들것인데, 맨 마지막 단계로 서버의 클라우드에 있는 컴퓨터에 Node.js 코드를 실행할 테니 `app.js` 로 이름을 만들어보자.

먼저 기능 몇개를 불러와야 하는데, Node.js에 기본으로 탑재된 몇 개의 `코어 모듈` 이 있다.
이후에 노드에 없는 `제 3자 모듈` 을 설치할 수도 있다.

코어모듈에는 `http / https / fs / path / os` 등이 있다.
파일 시스템에 있는 파일에 대한 경로를 구축하는 용도인 `path` 도 있고, 운영체제 관련 도움을 주는 `os` 도 있고, `http / https` 는 서버를 생성하거나 `http 요청 및 응답 작업` 에 아주 유용하다.

특히 `http` 는 서버를 출시하거나 요청을 보내는 것과 같은 작업에도 도움을 준다.
즉, `Node.js` 앱이 다른 서버로 요청을 보내 여러 서버간에 소통을 할 수 있다는 것이다.
`https` 의 경우 모든 전송 데이터가 암호화되는 `SSL 암호화 서버` 를 출시할 때 도움이 된다.

`http` 모듈을 먼저 사용해서 진행. 기본으로 전역에서 사용 가능하지 않으니 파일에서 해당 모듈을 불러와서 사용해야 한다.
`const http = require('http')`
여기에 특별한 키워드 및 기능이 있다. `Node.js` 는 전역으로 노출하는 특성이 있어서 Node.js로 실행하는 모든 파일에서 기본으로 `require` 이라는 키워드를 사용할 수 있다.

파일을 불러오는 방법인 `require` 키워드는 다른 파일로의 경로나 `Javscript` 파일을 불러올 수 있다. `./` 같은 경로를 생략하면 `글로벌 모듈` 을 찾게 되는데 `http` 는 탑재된 모듈 중 하나이기 때문에 글로벌 모듈의 기능을 사용할 수 있게 되는것이다.
`http` 객체에 실행할 수 있는 `필드 / 메서드` 가 `.` 를 작성해보면 많이 있는 것을 알 수 있는데 그 중 `createServer` 메소드는 이름 그대로 서버를 생성할 때 필요한 메소드이다.

`requestListener` 를 인수로 가진다는데 이는 쉽게 말해 들어오는 모든 요청을 실행하는 기능이다. requestListener는 두 개의 인수가 있어야 한다. 들어오는 메세지 혹은 응답 객체 유형의 요청을 받는다.
정리하자면 Node.js가 자동으로 들어오는 요청을 댑변하는 객체를 제공하고 해당 요청으로부터 데이터를 읽을 수 있게끔하며 요청을 보낸 사람에게 응답을 보낼 수 있는 응답 객체를 준다.

두 가지 인수에 원하는 이름을 붙일 수 있는데 `첫 번째 인수에는 요청에 대한 데이터 / 두 번째 인수는 응답에 사용되는 데이터` 이기 때문에 `req / res` 라는 이름을 자주 쓰게 된다.
함수를 명확하게 만들지 않고 `익명 함수` 로도 사용할 수 있다.

`createServer` 에 함수를 입력하면 서버에 요청이 들어올 때마다 노드가 함수를 실행하게 된다.
이게 바로 `Node.js` 의 주된 `이벤트 드리븐 아키텍처(EDA)` 이다.
즉, 요청이 들어오면 이 함수를 실행하라 알려주는 것이다. 이 함수를 `createServer callback function` 이라고 부른다.

서버에 요청이 들어올때마다 Node.js가 호출하게 되기 때문.
`console.log` 를 찍어보면 나오지 않는다. 그 이유는 서버에 요청을 보내지 않았기 때문인데 사실 서버가 어디에 있는지도 모른다. `주소` 가 필요한것이다.

`const server = http.createServer(rqListener);` 이렇게 서버를 할당해주고, 호출할 수 있는 많은 메소드가 있는데 그 중 하나가 `listen` 이다.
이 메소드는 `Node.js` 가 스크립트를 바로 종료하지 않고 계속 실행되면서 듣도록 한다.
이 메소드에 입력해야 하는 인수 여러 개중에 첫번째는 `포트` 이다. 듣고자하는 포트인데, 기본으로는 포트 번호 80이 사용되지만, `3000` 으로 사용해보자.

작성하고 `localhost:3000` 을 들어가보면 아무 일도 일어나지 않지만, 콘솔에서는 출력 결과가 나온것을 볼 수 있다.

```js
// app.js
const http = require("http");

function rqListener(req, res) {
  console.log(req);
}

const server = http.createServer(rqListener);

server.listen(3000);
```
