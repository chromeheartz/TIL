## Node Basic

### 13. Node Basic Summary

---

### 📌 요약

![](https://velog.velcdn.com/images/chromeheartz/post/63092edd-0f81-408a-8cd2-da043ef4d830/image.png)

가장 먼저 웹의 원리르 알아보았다.
클라이언트인 브라우저가 서버에 요청을 보내면 서버가 데이터베이스에 접촉해 파일을 다룬 후 HTML / 다른 종류의 응답을 클라이언트에 발송하고 브라우저가 이 응답을 보여준다.

전체적인 흐름 또한 보았는데, `Node.js` 프로그램이 서버에서 작동한다.
프로그램의 주기에 관련된 중요한 개념으로는 `이벤트 루프` 가 있었다.
`Node.js` 는 `논블로킹` 방식으로 실행된다.
즉, 수많은 콜백과 이벤트를 등록해두면 특정 작업이 끝난 후에 Node.js가 해당 코드를 작동시킨다는 뜻이다. 따라서 Javascript 스레드는 항상 새 이벤트나 새로 들어오는 요청 등을 다룰 수 있게 된다.
더 이상 작업이 없을 때는 프로그램이 종료되는데 서버에서는 절대 그럴 일이 없다.
`createServer` 가 절대 끝나지 않는 이벤트에 대한 이벤트 리스너를 등록하기 때문이다. 새로운 이벤트가 발생해도 즉, 새로운 요청이 들어와도 이벤트 리스너의 등록을 취소하지 않는다. 대신 서버는 계속해서 들어오는 요청을 들어야 한다.
따라서 이런 주기를 이해하는 것이 중요하다. 루프는 계속해서 새로운 이벤트를 기다리다가 이벤트가 발생하면 `운영체제` 가 어떠한 조취를 취하도록 한 다음 `스레드` 를 비운다.

여기에는 콜백을 통해 본 것처럼 많은 비동기식 코드가 필요하다.
Javascript 코드는 논블로킹 방식이어야해서 콜백 등 이벤트 기반 방식을 이용한다. 코드가 바로 실행되서 메인 스레드를 막지 않도록 등록해서 나중에 실행하게 한다.
어느 경우에도 `메인 스레드` 가 막히면 안될뿐더러 Node.js는 그런 문제를 피하도록 설계되었다.

청크로 도착하는 요청 데이터를 분석하는데 사용하는 `스트림 / 버퍼` 라는 개념도 배웠다. 또 이중 응답을 보내지 않도록 유의해야 한다.
즉, 한 `res` 가 끝난 다음에 다른 응답을 보내지 않아야 하는데 비동기식 특성에 따라 코드가 바로 실행되지 않을 수도 있다는 사실을 잊어버리면 실수하기 쉽다.

> 따라서 코드를 어디에 작성하느냐에 따라 예를 들어 이벤트 리스너의 경우 바로 실행되지 않는다는 점을 기억하는 것이 중요하다.

코어 모듈에는 `http / fs / path` 등의 모듈이 있고, 공식 Node.js 홈페이지를 찾아보면 더 많이 알 수 있다.
코어 모듈에는 서버에 원하는 어떤 작업이던 할 수 있도록 하는 몇 가지 기능이 있다.
예를 들어 `http` 모듈을 통해 새로운 서버를 생성할 수 있다. `require` 구문으로 불러오고 불러온 파일 내에서만 사용할 수 있다.

`module.exports` 르 사용해서 내보내거나 여러 개를 내보내기 할때는 `module` 을 뺀 숏컷으로도 사용할 수 있었다.

### 📌 유용한 자료

- 공식 Node.js 자료: https://nodejs.org/en/docs/guides/

- 모든 코어 모듈에 대한 Node.js 참고자료: https://nodejs.org/dist/latest/docs/api/

- Node.js 이벤트 루프 추가자료: https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/

- 블로킹 및 논블로킹 코드:https://nodejs.org/en/docs/guides/dont-block-the-event-loop/
