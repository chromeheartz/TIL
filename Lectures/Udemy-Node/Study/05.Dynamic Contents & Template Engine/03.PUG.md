## Dynamic Contents & Template Engine

### 03. PUG

---

### 📌 PUG 설치 및 구현

이제 다른 패키지를 설치해야 한다.
작업을 진행할 수 있도록 템플릿 엔진 3개를 설치할것이다.
`npm install --save` 로 설치를 진행하고 이 `3가지 엔진` 은 모두 Node 코드의 일부이며, 마지막에 일부 컴퓨터에 배포하게 되는 코드와 함께 전달되므로 `프로덕션 의존성` 으로 설치해야 한다.

`npm install --save ejs pug express-handlebars`

일단 하나하나 순차적으로 사용해봄으로써 구동 원리를 좀 더 상세하게 살펴보자.
먼저 `pug` 를 사용하려면 `app.js` 로 가서 알려야한다.
참고로 이는 `Node` 가 아닌 `Express` 의 기능으로 `Express.js` 사용을 선호하는 또 다른 이유는 `Node` 단독만으로는 이 과정을 전부 직접 수동으로 진행해야 하기 때문이다.

여기에서는 그저 Express를 준수하는 `템플릿 엔진` 이 있다고 알리기만 하면 된다. 그러니 `동적 템플릿을 렌더링` 할 때는 꼭 사용해야 한다.

```js
// app.js
const app = express();

app.set("view engine", "pug");
app.set("views", "views");
```

`Express` 앱을 생성하여 app상수에 저장한 뒤에는 `전체 구성값` 을 설정할 수 있다.

#### app.set

`app.set(name, value)` 형태를 사용하게 되면 Express 애플리케이션 전체에 어떤 값이든지 설정할 수 있으며, 이해할 수 없는 키라던가 구성 항목도 포함한다.

```js
app.set("title", "My Site");
app.get("title"); //  My Site
```

해당 형식으로 `app` 객체에서 읽게 세팅할 수도 있다.
즉 내가 설정함으로써 Express.js의 다양한 행동으로 이어지는 구성항목들을 사용할 수 있다. 현재 주의깊게 보아야 하는 것은 `view 엔진 / views 키` 이다.

#### view engine / views

`view engine` 은 Express에게 내가 렌더링 하려고 하는 `동적 템플릿` 이 있으니, 이를 실시 하기 위해 특별한 함수가 있으니 등록하는 이 엔진을 사용해달라고 알리며
`views` 는 Express에게 이러한 동적 `view` 를 어디에서 찾을 수 있는지 알리는 역할을 한다.

`pug` 를 사용하기 때문에 `pug` 를 템플릿 엔진으로 등록해주었다.
`view engine` 은 내장된 Express지원과 함께 전달되며 스스로를 자동으로 등록한다.

마지막으로 템플릿을 추가해야 한다.
`views` 에서 `shop.pug` 파일을 추가해보자.

```pug
// views/shop.pug
<!DOCTYPE html>
html(lang="en")
    head
        meta(charset="UTF-8")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        meta(http-equiv="X-UA-Compatible", content="ie=edge")
        title My Shop
        link(rel="stylesheet", href="/css/main.css")
        link(rel="stylesheet", href="/css/product.css")
    body
        header.main-header
            nav.main-header__nav
                ul.main-header__item-list
                    li.main-header__item
                        a.active(href="/") Shop
                    li.main-header__item
                        a(href="/admin/add-product") Add Product
```

`html5` 템플릿을 사용해서 기본 구조를 만들고, 기존에 만들었떤 html을 넣어준다.
`pug` 에서는 들여쓰기가 중요함으로 잘 정리해주어야 한다.

이 기점에서 `npm start` 를 실행하면 아무것도 보이지 않다. 그러나 여기에서는 이 템플릿을 렌더링 하지 않을 것이다. `Express` 에게 그렇게 전달하지 않고 있기 때문에, 대신 템플릿을 `렌더링 하려고 할 때마다` 해당 템플릿 엔진을 사용해야 한다고 전달하지만 그걸 시도하지는 않는다.
따라서 shop.js에서 응답을 정의하는데 지금은 HTML을 보내고 있지만 다른 작업으로 변경해주어야 한다.

```js
router.get("/", (req, res, next) => {
  res.render("shop");
});
```

그냥 `shop` 을 입력하기만 하면 된다. `pug` 를 기본 템플릿 엔진으로 정의했기 때문에 `.pug` 파일을 탐색할것이다.

![](https://velog.velcdn.com/images/chromeheartz/post/f35d2ce8-f44f-4961-8b46-d6770693a128/image.png)

잘 작동하는 것을 볼 수 있다.
