## NextJS Routing & Page Rendering

### 11. 병렬 및 인터셉트 라우트 결합하기

---

### 📌 병렬 및 인터셉트 라우트 결합하기

일단 기존에 했던 `h2` 를 지우고 `모달` 로 가로챈 페이지에서 보여주거나 일반 전체화면 페이지로 보여주려고 한다. 페이지에 도달한 방법에 따라.

우선 가로챈 라우트인 `page.js` 에 마크업을 추가하고 작업을 해볼것이다
`dialog` 로 `modal` 을 추가해보면 모달 뒤쪽이 아무것도 없는 것을 볼 수 있다.
이는 주변 레이아웃의 사용한 공간을 전부 차지하는 페이지이기 대문이다.

따라서 기존 페이지에 `오버레이` 로 만들려고한다면 `공유 레이아웃 / 병렬 라우팅` 기능을 사용해야 한다. `[slug]` 에 `layout` 을 하나 만들어준다.

```jsx
// news/[slug]/layout.js
export default function NewsDetailLayout({ children }) {
  return <>{children}</>;
}
```

⭐️ 이제 `병렬 라우팅` 을 설정한다.
두 라우트가 병렬로 표시되는데 `뉴스 항목 상세 페이지 / 모달 오버레이` 이 두개가 될것이다.

`(.)image` 와 형제 폴더로 `@modal` 를 만들어 주었다.

항상 보이길 원한다면 병렬 라우트로 작업할때 가능한 방법이 하나가 더 있다.
`별도의 병렬 라우트 폴더` 로 옮기는 대신, `layout.js` 파일이 기본 자식프로퍼티를 통해 사용가능하므로 이를 대안으로 슬 수 있다.
전용 병렬 라우트 하위 폴더를 만들지 않고, 진행이 가능.

#### 이번에는 가로채는 라우트를 위해 병렬 라우트 하위 폴더를 생성

`@modal` 안에 기존에 만든 `(.)image` 폴더를 넣어준다.

> ⭐️ 하위 폴더로 옮겼지만 `.`의 경로 설명은 바뀌지 않는다 `병렬 라우트 폴더` 는 무시하기 때문.
> 여기서 설명하는 경로는 `폴더 시스템 내 경로` 가 아니라 `폴더 구조 떄문에 렌더링 될 URL 경로` 에 있기 때문.

병렬라우트의 경우 이전에 `@archive / @latest` 등은 `URL` 에 아무것도 추가하지 않았다. 단지 `NextJS` 가 기대하는 방식으로 파일을 정리해줄 뿐. 하지만 `URL 경로` 이기 때문에 인터셉팅 라우트 폴더 안에서 처리되어야 한다.

![스크린샷 2025-01-13 오후 4 50 02](https://github.com/user-attachments/assets/bdeebf3b-56f5-467c-8a07-66de3d2fbc6b)
이런 폴더구조가 된다면 `@modal` 폴더 위에 위치하는 부모 파일 layout.js에서 `modal` 프로퍼티도 받을 수 있다. `modal` 을 식별자로 선택했기 때문.

따라서 이제 출력할 수 있다. `children` 콘텐츠 위에 출력할것인데, 모달 페이지 콘텐츠는 화면에 출력되고 상세 페이지 콘텐츠는 `children` 프로퍼티를 통해 사용가능하다.

📍 문제가 있다면 이 `모달 병렬 라우트` 는 중첩된 이미지 경로를 `가로채야만` 무언가를 출력한다는 것이다. 이후 모달을 열고 싶지만 `/news` 이후 `slug` 가 이씨을 때 해당 모달 병렬 라우트에서는 아무것도 출력하지 않는다.

<img width="743" alt="스크린샷 2025-01-13 오후 4 52 14" src="https://github.com/user-attachments/assets/5cbfe79a-71e1-4f0b-bb60-3a58aaabe363" />

⭐️ 따라서 새로고침 하면 상세페이지로 이동하게 되는데 이때 오류가 발생한다.

이런 패턴이 작동하려면 `default.js / page.js` 파일이 필요하다.
`@modal` 내부에 있으면서 가로채는 라우트 밖에 있어야 한다.
`null` 만 반환할것인데 이때는 무언가 반환해서 렌더링할게 없다는 것을 알려주어야 한다.

해당 경로에 컴포넌트가 없는 모습은 바람직하지 않기 때문.

<img width="654" alt="스크린샷 2025-01-13 오후 4 54 51" src="https://github.com/user-attachments/assets/b085417a-3023-433d-bb8e-8256e70cb48f" />

이렇게 하면 오버레이로 이미지가 열리는 것을 볼 수 있다.

> ✅ 다른 콘텐츠가 백그라운드에 여전히 보이는 것은 `병렬 라우트` 로 설정해놓았기 때문이다.
